<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Game.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">scacchi</a> &gt; <a href="index.source.html" class="el_package">it.uniba.main</a> &gt; <span class="el_source">Game.java</span></div><h1>Game.java</h1><pre class="source lang-java linenums">package it.uniba.main;

import java.util.ArrayList;

/**
 * &lt;&lt;entity&gt;&gt;&lt;br&gt;
 * Game is the main entity of the application. It contains the chessboard, turn of player currently
 * playing, white and black pieces captured, moves done. It also contains the main methods to
 * activate a move or a capture event for each piece.
 *
 * @author Megi Gjata
 * @author Mario Giordano
 * @author Donato Lucente
 * @author Patrick Clark
 * @author Filippo Iacobellis
 */
<span class="nc" id="L17">class Game {</span>
<span class="nc" id="L18">  private static boolean blackTurn = false;</span>
<span class="nc" id="L19">  private static Cell board[][] = new Cell[8][8];</span>
<span class="nc" id="L20">  private static ArrayList&lt;String&gt; movesDone = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L21">  private static ArrayList&lt;String&gt; BlacksCaptured = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L22">  private static ArrayList&lt;String&gt; WhitesCaptured = new ArrayList&lt;String&gt;();</span>

  void newGame() {
<span class="nc" id="L25">	blackTurn=false;</span>
<span class="nc" id="L26">    movesDone.clear();</span>
<span class="nc" id="L27">    BlacksCaptured.clear();</span>
<span class="nc" id="L28">    WhitesCaptured.clear();</span>
<span class="nc bnc" id="L29" title="All 2 branches missed.">    for (int j = 0; j &lt; 8; j++) {</span>
      // initialize pawns a2-h2 (white side)
<span class="nc" id="L31">      board[1][j] = new Cell(new Pawn(0));</span>

      // initialize pawns a7-h7 (black side)
<span class="nc" id="L34">      board[6][j] = new Cell(new Pawn(1));</span>
    }

    // initialize pieces a1-h1 (white side)
<span class="nc" id="L38">    board[0][0] = new Cell(new Rook(0));</span>
<span class="nc" id="L39">    board[0][1] = new Cell(new Knight(0));</span>
<span class="nc" id="L40">    board[0][2] = new Cell(new Bishop(0));</span>
<span class="nc" id="L41">    board[0][3] = new Cell(new Queen(0));</span>
<span class="nc" id="L42">    board[0][4] = new Cell(new King(0));</span>
<span class="nc" id="L43">    board[0][5] = new Cell(new Bishop(0));</span>
<span class="nc" id="L44">    board[0][6] = new Cell(new Knight(0));</span>
<span class="nc" id="L45">    board[0][7] = new Cell(new Rook(0));</span>

    // initialize empty cells
<span class="nc bnc" id="L48" title="All 2 branches missed.">    for (int i = 2; i &lt;= 5; i++) {</span>
<span class="nc bnc" id="L49" title="All 2 branches missed.">      for (int j = 0; j &lt; 8; j++) {</span>
<span class="nc" id="L50">        board[i][j] = new Cell(null);</span>
      }
    }

    // initialize pieces a8-h8 (black side)
<span class="nc" id="L55">    board[7][0] = new Cell(new Rook(1));</span>
<span class="nc" id="L56">    board[7][1] = new Cell(new Knight(1));</span>
<span class="nc" id="L57">    board[7][2] = new Cell(new Bishop(1));</span>
<span class="nc" id="L58">    board[7][3] = new Cell(new Queen(1));</span>
<span class="nc" id="L59">    board[7][4] = new Cell(new King(1));</span>
<span class="nc" id="L60">    board[7][5] = new Cell(new Bishop(1));</span>
<span class="nc" id="L61">    board[7][6] = new Cell(new Knight(1));</span>
<span class="nc" id="L62">    board[7][7] = new Cell(new Rook(1));</span>
<span class="nc" id="L63">  }</span>

  String[] moveAPawn(String input) throws IllegalMoveException {
<span class="nc bnc" id="L66" title="All 2 branches missed.">	  if (input.length() == 2) {</span>
          
<span class="nc" id="L68">          return Pawn.move(input);</span>
       
<span class="nc bnc" id="L70" title="All 2 branches missed.">      } else if (input.length() == 4) {</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">        if (input.substring(1, 2).equals(&quot;x&quot;)) {</span>

          
<span class="nc" id="L74">            return Pawn.capture(input);</span>
            
            
         
<span class="nc" id="L78">        } throw new IllegalMoveException(&quot;Mossa non valida&quot;);</span>

<span class="nc bnc" id="L80" title="All 2 branches missed.">      } else if (input.length() == 8) {</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">        if ((input.substring(1, 2).toLowerCase().equals(&quot;x&quot;))</span>
<span class="nc bnc" id="L82" title="All 2 branches missed.">            &amp;&amp; (input.substring(4, 8).toLowerCase().equals(&quot;e.p.&quot;))) {</span>

         
<span class="nc" id="L85">            return  Pawn.captureEnPassant(input);</span>
            
          
<span class="nc" id="L88">        } else throw new IllegalMoveException(&quot;Mossa non valida&quot;);</span>

<span class="nc bnc" id="L90" title="All 2 branches missed.">      } else if (input.length() == 6) {</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">        if ((input.substring(1, 2).toLowerCase().equals(&quot;x&quot;))</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">            &amp;&amp; (input.substring(4, 6).toLowerCase().equals(&quot;ep&quot;))) {</span>

          
<span class="nc" id="L95">            return Pawn.captureEnPassant(input);</span>
            
          
<span class="nc" id="L98">        } else throw new IllegalMoveException(&quot;Mossa non valida&quot;);</span>
      } else
<span class="nc" id="L100">      throw new IllegalMoveException(</span>
            &quot;Mossa illegale o comando inesistente; Riprova utilizzando un comando consentito o inserisci una mossa legale&quot;);
  }
  
  String[] moveKing(String move) throws IllegalMoveException {
<span class="nc" id="L105">	  return King.move(move);</span>
  }

  String[] moveQueen(String move) throws IllegalMoveException {
    int x; // ascissa
    int y; // ordinata
    int vCheck; // sentinella dell'ascissa
    int hCheck; // sentinella dell'ordinata
    Queen q;
<span class="nc" id="L114">    String[] pieceAndCell = new String[3]; //0 Donna, 2 cella di dest</span>

<span class="nc" id="L116">    y = (int) move.charAt(1) - 97;</span>
<span class="nc" id="L117">    x = 8 - Integer.parseInt(move.substring(2, 3));</span>
    
<span class="nc bnc" id="L119" title="All 2 branches missed.">      if (board[x][y].getPiece() == null) {</span>
<span class="nc" id="L120">        vCheck = x + 1; // controllo in verticale, verso il basso (della matrice)</span>
<span class="nc bnc" id="L121" title="All 2 branches missed.">        while (vCheck &lt; 8) {</span>
<span class="nc bnc" id="L122" title="All 2 branches missed.">          if ((board[vCheck][y].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L123" title="All 4 branches missed.">              &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L124">            q = (Queen) board[vCheck][y].getPiece();</span>
<span class="nc" id="L125">            board[vCheck][y].setEmpty();</span>
<span class="nc" id="L126">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L128">              board[x][y].setEmpty();</span>
<span class="nc" id="L129">              board[vCheck][y].setPiece(q);</span>
<span class="nc" id="L130">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L133">              movesDone.add(move);</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L135">              pieceAndCell[0] = q.toString();</span>
<span class="nc" id="L136">              pieceAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L137">              return pieceAndCell;</span>
            }

<span class="nc bnc" id="L140" title="All 2 branches missed.">          } else if (board[vCheck][y].getPiece() != null) {</span>
<span class="nc" id="L141">            break;</span>
          } else {
<span class="nc" id="L143">            vCheck++;</span>
          }
        }
<span class="nc" id="L146">        vCheck = x - 1;</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">        while (vCheck &gt;= 0) { // controllo in verticale, verso l'alto (della matrice)</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">          if ((board[vCheck][y].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L149" title="All 4 branches missed.">              &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L150">            q = (Queen) board[vCheck][y].getPiece();</span>
<span class="nc" id="L151">            board[vCheck][y].setEmpty();</span>
<span class="nc" id="L152">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L153" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L154">              board[x][y].setEmpty();</span>
<span class="nc" id="L155">              board[vCheck][y].setPiece(q);</span>
<span class="nc" id="L156">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L158">              movesDone.add(move);</span>
<span class="nc bnc" id="L159" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L160">              pieceAndCell[0] = q.toString();</span>
<span class="nc" id="L161">              pieceAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L162">              return pieceAndCell;</span>
            }
<span class="nc bnc" id="L164" title="All 2 branches missed.">          } else if (board[vCheck][y].getPiece() != null) {</span>
<span class="nc" id="L165">            break;</span>
          } else {
<span class="nc" id="L167">            vCheck--;</span>
          }
        }
<span class="nc" id="L170">        hCheck = y + 1; // controllo in orizzontale a destra</span>
<span class="nc bnc" id="L171" title="All 2 branches missed.">        while (hCheck &lt; 8) {</span>
<span class="nc bnc" id="L172" title="All 2 branches missed.">          if ((board[x][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L173" title="All 4 branches missed.">              &amp;&amp; (board[x][hCheck].getPiece().getColor() == (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L174">            q = (Queen) board[x][hCheck].getPiece();</span>
<span class="nc" id="L175">            board[x][hCheck].setEmpty();</span>
<span class="nc" id="L176">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L177" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L178">              board[x][y].setEmpty();</span>
<span class="nc" id="L179">              board[x][hCheck].setPiece(q);</span>
<span class="nc" id="L180">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L182">              movesDone.add(move);</span>
<span class="nc bnc" id="L183" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L184">              pieceAndCell[0] = q.toString();</span>
<span class="nc" id="L185">              pieceAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L186">              return pieceAndCell;</span>
            }
<span class="nc bnc" id="L188" title="All 2 branches missed.">          } else if (board[x][hCheck].getPiece() != null) {</span>
<span class="nc" id="L189">            break;</span>
          } else {
<span class="nc" id="L191">            hCheck++;</span>
          }
        }
<span class="nc" id="L194">        hCheck = y - 1;</span>
<span class="nc bnc" id="L195" title="All 2 branches missed.">        while (hCheck &gt;= 0) { // controllo in orizzontale a sinistra</span>
<span class="nc bnc" id="L196" title="All 2 branches missed.">          if ((board[x][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L197" title="All 4 branches missed.">              &amp;&amp; (board[x][hCheck].getPiece().getColor() == (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L198">            q = (Queen) board[x][hCheck].getPiece();</span>
<span class="nc" id="L199">            board[x][hCheck].setEmpty();</span>
<span class="nc" id="L200">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L201" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L202">              board[x][y].setEmpty();</span>
<span class="nc" id="L203">              board[x][hCheck].setPiece(q);</span>
<span class="nc" id="L204">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L206">              movesDone.add(move);</span>
<span class="nc bnc" id="L207" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L208">              pieceAndCell[0] = q.toString();</span>
<span class="nc" id="L209">              pieceAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L210">              return pieceAndCell;</span>
            }
<span class="nc bnc" id="L212" title="All 2 branches missed.">          } else if (board[x][hCheck].getPiece() != null) {</span>
<span class="nc" id="L213">            break;</span>
          } else {
<span class="nc" id="L215">            hCheck--;</span>
          }
        }
<span class="nc" id="L218">        vCheck = x - 1;</span>
<span class="nc" id="L219">        hCheck = y - 1;</span>
<span class="nc bnc" id="L220" title="All 4 branches missed.">        while (vCheck &gt;= 0 &amp;&amp; hCheck &gt;= 0) { // controllo diagonale alta sinistra</span>
<span class="nc bnc" id="L221" title="All 2 branches missed.">          if ((board[vCheck][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L222" title="All 4 branches missed.">              &amp;&amp; (board[vCheck][hCheck].getPiece().getColor() == (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L223">            q = (Queen) board[vCheck][hCheck].getPiece();</span>
<span class="nc" id="L224">            board[vCheck][hCheck].setEmpty();</span>
<span class="nc" id="L225">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L227">              board[x][y].setEmpty();</span>
<span class="nc" id="L228">              board[vCheck][hCheck].setPiece(q);</span>
<span class="nc" id="L229">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L231">              movesDone.add(move);</span>
<span class="nc bnc" id="L232" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L233">              pieceAndCell[0] = q.toString();</span>
<span class="nc" id="L234">              pieceAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L235">              return pieceAndCell;</span>
            }
<span class="nc bnc" id="L237" title="All 2 branches missed.">          } else if (board[vCheck][hCheck].getPiece() != null) {</span>
<span class="nc" id="L238">            break;</span>
          } else {
<span class="nc" id="L240">            vCheck--;</span>
<span class="nc" id="L241">            hCheck--;</span>
          }
        }
<span class="nc" id="L244">        vCheck = x - 1;</span>
<span class="nc" id="L245">        hCheck = y + 1;</span>
<span class="nc bnc" id="L246" title="All 4 branches missed.">        while (vCheck &gt;= 0 &amp;&amp; hCheck &lt; 8) { // controllo diagonale alta destra</span>
<span class="nc bnc" id="L247" title="All 2 branches missed.">          if ((board[vCheck][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L248" title="All 4 branches missed.">              &amp;&amp; (board[vCheck][hCheck].getPiece().getColor() == (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L249">            q = (Queen) board[vCheck][hCheck].getPiece();</span>
<span class="nc" id="L250">            board[vCheck][hCheck].setEmpty();</span>
<span class="nc" id="L251">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L252" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L253">              board[x][y].setEmpty();</span>
<span class="nc" id="L254">              board[vCheck][hCheck].setPiece(q);</span>
<span class="nc" id="L255">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L257">              movesDone.add(move);</span>
<span class="nc bnc" id="L258" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L259">              pieceAndCell[0] = q.toString();</span>
<span class="nc" id="L260">              pieceAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L261">              return pieceAndCell;</span>
            }
<span class="nc bnc" id="L263" title="All 2 branches missed.">          } else if (board[vCheck][hCheck].getPiece() != null) {</span>
<span class="nc" id="L264">            break;</span>
          } else {
<span class="nc" id="L266">            vCheck--;</span>
<span class="nc" id="L267">            hCheck++;</span>
          }
        }
<span class="nc" id="L270">        vCheck = x + 1;</span>
<span class="nc" id="L271">        hCheck = y - 1;</span>
<span class="nc bnc" id="L272" title="All 4 branches missed.">        while (vCheck &lt; 8 &amp;&amp; hCheck &gt;= 0) { // controllo diagonale bassa sinistra</span>
<span class="nc bnc" id="L273" title="All 2 branches missed.">          if ((board[vCheck][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L274" title="All 4 branches missed.">              &amp;&amp; (board[vCheck][hCheck].getPiece().getColor() == (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L275">            q = (Queen) board[vCheck][hCheck].getPiece();</span>
<span class="nc" id="L276">            board[vCheck][hCheck].setEmpty();</span>
<span class="nc" id="L277">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L278" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L279">              board[x][y].setEmpty();</span>
<span class="nc" id="L280">              board[vCheck][hCheck].setPiece(q);</span>
<span class="nc" id="L281">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L283">              movesDone.add(move);</span>
<span class="nc bnc" id="L284" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L285">              pieceAndCell[0] = q.toString();</span>
<span class="nc" id="L286">              pieceAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L287">              return pieceAndCell;</span>
            }
<span class="nc bnc" id="L289" title="All 2 branches missed.">          } else if (board[vCheck][hCheck].getPiece() != null) {</span>
<span class="nc" id="L290">            break;</span>
          } else {
<span class="nc" id="L292">            vCheck++;</span>
<span class="nc" id="L293">            hCheck--;</span>
          }
        }

<span class="nc" id="L297">        vCheck = x + 1;</span>
<span class="nc" id="L298">        hCheck = y + 1;</span>
<span class="nc bnc" id="L299" title="All 4 branches missed.">        while (vCheck &lt; 8 &amp;&amp; hCheck &lt; 8) { // controllo diagonale bassa destra</span>
<span class="nc bnc" id="L300" title="All 2 branches missed.">          if ((board[vCheck][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L301" title="All 4 branches missed.">              &amp;&amp; (board[vCheck][hCheck].getPiece().getColor() == (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L302">            q = (Queen) board[vCheck][hCheck].getPiece();</span>
<span class="nc" id="L303">            board[vCheck][hCheck].setEmpty();</span>
<span class="nc" id="L304">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L305" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L306">              board[x][y].setEmpty();</span>
<span class="nc" id="L307">              board[vCheck][hCheck].setPiece(q);</span>
<span class="nc" id="L308">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L310">              movesDone.add(move);</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L312">              pieceAndCell[0] = q.toString();</span>
<span class="nc" id="L313">              pieceAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L314">              return pieceAndCell;</span>
            }
<span class="nc bnc" id="L316" title="All 2 branches missed.">          } else if (board[vCheck][hCheck].getPiece() != null) {</span>
<span class="nc" id="L317">            break;</span>
          } else {
<span class="nc" id="L319">            vCheck++;</span>
<span class="nc" id="L320">            hCheck++;</span>
          }
        }
<span class="nc" id="L323">        throw new IllegalMoveException(&quot;Mossa illegale; La donna non puo' muoversi qui&quot;);</span>

      } else
<span class="nc" id="L326">        throw new IllegalMoveException(&quot;Mossa illegale; La cella di destinazione non e' vuota&quot;);</span>

  }

  String[] captureQueen(String move) throws IllegalMoveException {
    int x; // ascissa
    int y; // ordinata
    int vCheck; // sentinella dell'ascissa
    int hCheck; // sentinella dell'ordinata
    Queen q;
    Piece caught;
<span class="nc" id="L337">    String pieces[] = new String[3];</span>
    
<span class="nc" id="L339">    y = (int) move.charAt(2) - 97;</span>
<span class="nc" id="L340">    x = 8 - Integer.parseInt(move.substring(3, 4));</span>
<span class="nc bnc" id="L341" title="All 2 branches missed.">      if (board[x][y].getPiece() != null) {</span>
<span class="nc" id="L342">        vCheck = x + 1; // controllo in verticale, verso il basso (della matrice)</span>
<span class="nc bnc" id="L343" title="All 2 branches missed.">        while (vCheck &lt; 8) {</span>
<span class="nc bnc" id="L344" title="All 2 branches missed.">          if ((board[vCheck][y].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L345" title="All 4 branches missed.">              &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))</span>
<span class="nc bnc" id="L346" title="All 4 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() != (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L347">            q = (Queen) board[vCheck][y].getPiece();</span>
<span class="nc" id="L348">            caught = (Piece) board[x][y].getPiece();</span>
<span class="nc" id="L349">            pieces[0] = q.toString();</span>
<span class="nc" id="L350">            pieces[1] = caught.toString();</span>
<span class="nc" id="L351">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L352">            board[vCheck][y].setEmpty();</span>
<span class="nc" id="L353">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L354" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L355">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L356">              board[vCheck][y].setPiece(q);</span>
<span class="nc" id="L357">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc bnc" id="L359" title="All 2 branches missed.">              if (blackTurn) {</span>
<span class="nc" id="L360">              BlacksCaptured.add(caught.toString());</span>
              } else {
<span class="nc" id="L362">                WhitesCaptured.add(caught.toString());</span>
              }
<span class="nc" id="L364">              movesDone.add(move);</span>
<span class="nc bnc" id="L365" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L366">              return pieces;</span>
            }

<span class="nc bnc" id="L369" title="All 2 branches missed.">          } else if (board[vCheck][y].getPiece() != null) {</span>
<span class="nc" id="L370">            break;</span>
          } else {
<span class="nc" id="L372">            vCheck++;</span>
          }
        }
<span class="nc" id="L375">        vCheck = x - 1;</span>
<span class="nc bnc" id="L376" title="All 2 branches missed.">        while (vCheck &gt;= 0) { // controllo in verticale, verso l'alto (della matrice)</span>
<span class="nc bnc" id="L377" title="All 2 branches missed.">          if ((board[vCheck][y].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L378" title="All 4 branches missed.">          &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))</span>
<span class="nc bnc" id="L379" title="All 4 branches missed.">          &amp;&amp; (board[x][y].getPiece().getColor() != (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L380">            q = (Queen) board[vCheck][y].getPiece();</span>
<span class="nc" id="L381">            caught = (Piece) board[x][y].getPiece();</span>
<span class="nc" id="L382">            pieces[0] = q.toString();</span>
<span class="nc" id="L383">            pieces[1] = caught.toString();</span>
<span class="nc" id="L384">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L385">            board[vCheck][y].setEmpty();</span>
<span class="nc" id="L386">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L387" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L388">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L389">              board[vCheck][y].setPiece(q);</span>
<span class="nc" id="L390">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc bnc" id="L392" title="All 2 branches missed.">              if (blackTurn) {</span>
<span class="nc" id="L393">                BlacksCaptured.add(caught.toString());</span>
                } else {
<span class="nc" id="L395">                  WhitesCaptured.add(caught.toString());</span>
                }
<span class="nc" id="L397">              movesDone.add(move);</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L399">              return pieces;</span>
            }
<span class="nc bnc" id="L401" title="All 2 branches missed.">          } else if (board[vCheck][y].getPiece() != null) {</span>
<span class="nc" id="L402">            break;</span>
          } else {
<span class="nc" id="L404">            vCheck--;</span>
          }
        }
<span class="nc" id="L407">        hCheck = y + 1; // controllo in orizzontale a destra</span>
<span class="nc bnc" id="L408" title="All 2 branches missed.">        while (hCheck &lt; 8) {</span>
<span class="nc bnc" id="L409" title="All 2 branches missed.">          if ((board[x][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L410" title="All 4 branches missed.">          &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))</span>
<span class="nc bnc" id="L411" title="All 4 branches missed.">          &amp;&amp; (board[x][y].getPiece().getColor() != (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L412">            q = (Queen) board[x][hCheck].getPiece();</span>
<span class="nc" id="L413">            caught = (Piece) board[x][y].getPiece();</span>
<span class="nc" id="L414">            pieces[0] = q.toString();</span>
<span class="nc" id="L415">            pieces[1] = caught.toString();</span>
<span class="nc" id="L416">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L417">            board[x][hCheck].setEmpty();</span>
<span class="nc" id="L418">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L419" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L420">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L421">              board[x][hCheck].setPiece(q);</span>
<span class="nc" id="L422">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc bnc" id="L424" title="All 2 branches missed.">              if (blackTurn) {</span>
<span class="nc" id="L425">                BlacksCaptured.add(caught.toString());</span>
                } else {
<span class="nc" id="L427">                  WhitesCaptured.add(caught.toString());</span>
                }
<span class="nc" id="L429">              movesDone.add(move);</span>
<span class="nc bnc" id="L430" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L431">              return pieces;</span>
            }
<span class="nc bnc" id="L433" title="All 2 branches missed.">          } else if (board[x][hCheck].getPiece() != null) {</span>
<span class="nc" id="L434">            break;</span>
          } else {
<span class="nc" id="L436">            hCheck++;</span>
          }
        }
<span class="nc" id="L439">        hCheck = y - 1;</span>
<span class="nc bnc" id="L440" title="All 2 branches missed.">        while (hCheck &gt;= 0) { // controllo in orizzontale a sinistra</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">          if ((board[x][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L442" title="All 4 branches missed.">          &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))</span>
<span class="nc bnc" id="L443" title="All 4 branches missed.">          &amp;&amp; (board[x][y].getPiece().getColor() != (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L444">            q = (Queen) board[x][hCheck].getPiece();</span>
<span class="nc" id="L445">            caught = (Piece) board[x][y].getPiece();</span>
<span class="nc" id="L446">            pieces[0] = q.toString();</span>
<span class="nc" id="L447">            pieces[1] = caught.toString();</span>
<span class="nc" id="L448">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L449">            board[x][hCheck].setEmpty();</span>
<span class="nc" id="L450">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L451" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L452">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L453">              board[x][hCheck].setPiece(q);</span>
<span class="nc" id="L454">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc bnc" id="L456" title="All 2 branches missed.">              if (blackTurn) {</span>
<span class="nc" id="L457">                BlacksCaptured.add(caught.toString());</span>
                } else {
<span class="nc" id="L459">                  WhitesCaptured.add(caught.toString());</span>
                }
<span class="nc" id="L461">              movesDone.add(move);</span>
<span class="nc bnc" id="L462" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L463">              return pieces;</span>
            }
<span class="nc bnc" id="L465" title="All 2 branches missed.">          } else if (board[x][hCheck].getPiece() != null) {</span>
<span class="nc" id="L466">            break;</span>
          } else {
<span class="nc" id="L468">            hCheck--;</span>
          }
        }
<span class="nc" id="L471">        vCheck = x - 1;</span>
<span class="nc" id="L472">        hCheck = y - 1;</span>
<span class="nc bnc" id="L473" title="All 4 branches missed.">        while (vCheck &gt;= 0 &amp;&amp; hCheck &gt;= 0) { // controllo diagonale alta sinistra</span>
<span class="nc bnc" id="L474" title="All 2 branches missed.">          if ((board[vCheck][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L475" title="All 4 branches missed.">          &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))</span>
<span class="nc bnc" id="L476" title="All 4 branches missed.">          &amp;&amp; (board[x][y].getPiece().getColor() != (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L477">            q = (Queen) board[vCheck][hCheck].getPiece();</span>
<span class="nc" id="L478">            caught = (Piece) board[x][y].getPiece();</span>
<span class="nc" id="L479">            pieces[0] = q.toString();</span>
<span class="nc" id="L480">            pieces[1] = caught.toString();</span>
<span class="nc" id="L481">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L482">            board[vCheck][hCheck].setEmpty();</span>
<span class="nc" id="L483">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L484" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L485">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L486">              board[vCheck][hCheck].setPiece(q);</span>
<span class="nc" id="L487">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc bnc" id="L489" title="All 2 branches missed.">              if (blackTurn) {</span>
<span class="nc" id="L490">                BlacksCaptured.add(caught.toString());</span>
                } else {
<span class="nc" id="L492">                  WhitesCaptured.add(caught.toString());</span>
                }
<span class="nc" id="L494">              movesDone.add(move);</span>
<span class="nc bnc" id="L495" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L496">              return pieces;</span>
            }
<span class="nc bnc" id="L498" title="All 2 branches missed.">          } else if (board[vCheck][hCheck].getPiece() != null) {</span>
<span class="nc" id="L499">            break;</span>
          } else {
<span class="nc" id="L501">            vCheck--;</span>
<span class="nc" id="L502">            hCheck--;</span>
          }
        }
<span class="nc" id="L505">        vCheck = x - 1;</span>
<span class="nc" id="L506">        hCheck = y + 1;</span>
<span class="nc bnc" id="L507" title="All 4 branches missed.">        while (vCheck &gt;= 0 &amp;&amp; hCheck &lt; 8) { // controllo diagonale alta destra</span>
<span class="nc bnc" id="L508" title="All 2 branches missed.">          if ((board[vCheck][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L509" title="All 4 branches missed.">          &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))</span>
<span class="nc bnc" id="L510" title="All 4 branches missed.">          &amp;&amp; (board[x][y].getPiece().getColor() != (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L511">            q = (Queen) board[vCheck][hCheck].getPiece();</span>
<span class="nc" id="L512">            caught = (Piece) board[x][y].getPiece();</span>
<span class="nc" id="L513">            pieces[0] = q.toString();</span>
<span class="nc" id="L514">            pieces[1] = caught.toString();</span>
<span class="nc" id="L515">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L516">            board[vCheck][hCheck].setEmpty();</span>
<span class="nc" id="L517">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L518" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L519">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L520">              board[vCheck][hCheck].setPiece(q);</span>
<span class="nc" id="L521">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc bnc" id="L523" title="All 2 branches missed.">              if (blackTurn) {</span>
<span class="nc" id="L524">                BlacksCaptured.add(caught.toString());</span>
                } else {
<span class="nc" id="L526">                  WhitesCaptured.add(caught.toString());</span>
                }
<span class="nc" id="L528">              movesDone.add(move);</span>
<span class="nc bnc" id="L529" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L530">              return pieces;</span>
            }
<span class="nc bnc" id="L532" title="All 2 branches missed.">          } else if (board[vCheck][hCheck].getPiece() != null) {</span>
<span class="nc" id="L533">            break;</span>
          } else {
<span class="nc" id="L535">            vCheck--;</span>
<span class="nc" id="L536">            hCheck++;</span>
          }
        }
<span class="nc" id="L539">        vCheck = x + 1;</span>
<span class="nc" id="L540">        hCheck = y - 1;</span>
<span class="nc bnc" id="L541" title="All 4 branches missed.">        while (vCheck &lt; 8 &amp;&amp; hCheck &gt;= 0) { // controllo diagonale bassa sinistra</span>
<span class="nc bnc" id="L542" title="All 2 branches missed.">          if ((board[vCheck][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L543" title="All 4 branches missed.">          &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))</span>
<span class="nc bnc" id="L544" title="All 4 branches missed.">          &amp;&amp; (board[x][y].getPiece().getColor() != (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L545">            q = (Queen) board[vCheck][hCheck].getPiece();</span>
<span class="nc" id="L546">            caught = (Piece) board[x][y].getPiece();</span>
<span class="nc" id="L547">            pieces[0] = q.toString();</span>
<span class="nc" id="L548">            pieces[1] = caught.toString();</span>
<span class="nc" id="L549">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L550">            board[vCheck][hCheck].setEmpty();</span>
<span class="nc" id="L551">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L552" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L553">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L554">              board[vCheck][hCheck].setPiece(q);</span>
<span class="nc" id="L555">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc bnc" id="L557" title="All 2 branches missed.">              if (blackTurn) {</span>
<span class="nc" id="L558">                BlacksCaptured.add(caught.toString());</span>
                } else {
<span class="nc" id="L560">                  WhitesCaptured.add(caught.toString());</span>
                }
<span class="nc" id="L562">              movesDone.add(move);</span>
<span class="nc bnc" id="L563" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L564">              return pieces;</span>
            }
<span class="nc bnc" id="L566" title="All 2 branches missed.">          } else if (board[vCheck][hCheck].getPiece() != null) {</span>
<span class="nc" id="L567">            break;</span>
          } else {
<span class="nc" id="L569">            vCheck++;</span>
<span class="nc" id="L570">            hCheck--;</span>
          }
        }

<span class="nc" id="L574">        vCheck = x + 1;</span>
<span class="nc" id="L575">        hCheck = y + 1;</span>
<span class="nc bnc" id="L576" title="All 4 branches missed.">        while (vCheck &lt; 8 &amp;&amp; hCheck &lt; 8) { // controllo diagonale bassa destra</span>
<span class="nc bnc" id="L577" title="All 2 branches missed.">          if ((board[vCheck][hCheck].getPiece() instanceof Queen)</span>
<span class="nc bnc" id="L578" title="All 4 branches missed.">          &amp;&amp; (board[vCheck][y].getPiece().getColor() == (blackTurn ? 0 : 1))</span>
<span class="nc bnc" id="L579" title="All 4 branches missed.">          &amp;&amp; (board[x][y].getPiece().getColor() != (blackTurn ? 0 : 1))) {</span>
<span class="nc" id="L580">            q = (Queen) board[vCheck][hCheck].getPiece();</span>
<span class="nc" id="L581">            caught = (Piece) board[x][y].getPiece();</span>
<span class="nc" id="L582">            pieces[0] = q.toString();</span>
<span class="nc" id="L583">            pieces[1] = caught.toString();</span>
<span class="nc" id="L584">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L585">            board[vCheck][hCheck].setEmpty();</span>
<span class="nc" id="L586">            board[x][y].setPiece(q);</span>
<span class="nc bnc" id="L587" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L588">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L589">              board[vCheck][hCheck].setPiece(q);</span>
<span class="nc" id="L590">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc bnc" id="L592" title="All 2 branches missed.">              if (blackTurn) {</span>
<span class="nc" id="L593">                BlacksCaptured.add(caught.toString());</span>
                } else {
<span class="nc" id="L595">                  WhitesCaptured.add(caught.toString());</span>
                }
<span class="nc" id="L597">              movesDone.add(move);</span>
<span class="nc bnc" id="L598" title="All 2 branches missed.">              blackTurn = !blackTurn;</span>
<span class="nc" id="L599">              return pieces;</span>
            }
<span class="nc bnc" id="L601" title="All 2 branches missed.">          } else if (board[vCheck][hCheck].getPiece() != null) {</span>
<span class="nc" id="L602">            break;</span>
          } else {
<span class="nc" id="L604">            vCheck++;</span>
<span class="nc" id="L605">            hCheck++;</span>
          }
        }
<span class="nc" id="L608">        throw new IllegalMoveException(</span>

            &quot;Mossa illegale; La donna non puo' effettuare la cattura nella cella di destinazione data&quot;);
<span class="nc" id="L611">      } else throw new IllegalMoveException(&quot;Mossa illegale; La cella di destinazione e' vuota&quot;);</span>

  }

  String[] moveBishop(String move) throws IllegalMoveException {
    int x;
    int y;
    int xB;
    int yB;
    Bishop b;

<span class="nc" id="L622">    y = (int) move.charAt(1) - 97;</span>
<span class="nc" id="L623">    x = 8 - Integer.parseInt(move.substring(2, 3));</span>
<span class="nc" id="L624">    String[] piecesAndCell = new String[3];</span>

<span class="nc bnc" id="L626" title="All 2 branches missed.">    if (blackTurn == true) { // tutti i controlli per i pezzi bianchi</span>
<span class="nc bnc" id="L627" title="All 2 branches missed.">      if (board[x][y].getPiece() == null) {</span>
<span class="nc" id="L628">        xB = x - 1;</span>
<span class="nc" id="L629">        yB = y - 1;</span>
<span class="nc bnc" id="L630" title="All 4 branches missed.">        while (xB &gt;= 0 &amp;&amp; yB &gt;= 0) {</span>
<span class="nc bnc" id="L631" title="All 2 branches missed.">          if (board[xB][yB].getPiece() instanceof Bishop</span>
<span class="nc bnc" id="L632" title="All 2 branches missed.">              &amp;&amp; board[xB][yB].getPiece().getColor() == 0) {</span>
<span class="nc" id="L633">            b = (Bishop) board[xB][yB].getPiece();</span>
<span class="nc" id="L634">            board[xB][yB].setEmpty();</span>
<span class="nc" id="L635">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L636" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L637">              board[xB][yB].setPiece(b);</span>
<span class="nc" id="L638">              board[x][y].setEmpty();</span>
<span class="nc" id="L639">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L642">              movesDone.add(move);</span>
<span class="nc" id="L643">              blackTurn = false;</span>
<span class="nc" id="L644">              piecesAndCell[0] = b.toString();</span>
<span class="nc" id="L645">              piecesAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L646">              return piecesAndCell;</span>
            }
<span class="nc bnc" id="L648" title="All 2 branches missed.">          } else if (board[xB][yB].getPiece() != null) {</span>
<span class="nc" id="L649">            break;</span>
          } else {
<span class="nc" id="L651">            xB--;</span>
<span class="nc" id="L652">            yB--;</span>
          }
        }
<span class="nc" id="L655">        xB = x - 1;</span>
<span class="nc" id="L656">        yB = y + 1;</span>
<span class="nc bnc" id="L657" title="All 4 branches missed.">        while (xB &gt;= 0 &amp;&amp; yB &lt; 8) {</span>
<span class="nc bnc" id="L658" title="All 2 branches missed.">          if (board[xB][yB].getPiece() instanceof Bishop</span>
<span class="nc bnc" id="L659" title="All 2 branches missed.">              &amp;&amp; board[xB][yB].getPiece().getColor() == 0) {</span>
<span class="nc" id="L660">            b = (Bishop) board[xB][yB].getPiece();</span>
<span class="nc" id="L661">            board[xB][yB].setEmpty();</span>
<span class="nc" id="L662">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L663" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L664">              board[xB][yB].setPiece(b);</span>
<span class="nc" id="L665">              board[x][y].setEmpty();</span>
<span class="nc" id="L666">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L669">              movesDone.add(move);</span>
<span class="nc" id="L670">              blackTurn = false;</span>
<span class="nc" id="L671">              piecesAndCell[0] = b.toString();</span>
<span class="nc" id="L672">              piecesAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L673">              return piecesAndCell;</span>
            }
<span class="nc bnc" id="L675" title="All 2 branches missed.">          } else if (board[xB][yB].getPiece() != null) {</span>
<span class="nc" id="L676">            break;</span>
          } else {
<span class="nc" id="L678">            xB--;</span>
<span class="nc" id="L679">            yB++;</span>
          }
        }
<span class="nc" id="L682">        xB = x + 1;</span>
<span class="nc" id="L683">        yB = y - 1;</span>
<span class="nc bnc" id="L684" title="All 4 branches missed.">        while (xB &lt; 8 &amp;&amp; yB &gt;= 0) {</span>
<span class="nc bnc" id="L685" title="All 2 branches missed.">          if (board[xB][yB].getPiece() instanceof Bishop</span>
<span class="nc bnc" id="L686" title="All 2 branches missed.">              &amp;&amp; board[xB][yB].getPiece().getColor() == 0) {</span>
<span class="nc" id="L687">            b = (Bishop) board[xB][yB].getPiece();</span>
<span class="nc" id="L688">            board[xB][yB].setEmpty();</span>
<span class="nc" id="L689">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L690" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L691">              board[xB][yB].setPiece(b);</span>
<span class="nc" id="L692">              board[x][y].setEmpty();</span>
<span class="nc" id="L693">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L696">              movesDone.add(move);</span>
<span class="nc" id="L697">              blackTurn = false;</span>
<span class="nc" id="L698">              piecesAndCell[0] = b.toString();</span>
<span class="nc" id="L699">              piecesAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L700">              return piecesAndCell;</span>
            }
<span class="nc bnc" id="L702" title="All 2 branches missed.">          } else if (board[xB][yB].getPiece() != null) {</span>
<span class="nc" id="L703">            break;</span>
          } else {
<span class="nc" id="L705">            xB++;</span>
<span class="nc" id="L706">            yB--;</span>
          }
        }
<span class="nc" id="L709">        xB = x + 1;</span>
<span class="nc" id="L710">        yB = y + 1;</span>
<span class="nc bnc" id="L711" title="All 4 branches missed.">        while (xB &lt; 8 &amp;&amp; yB &lt; 8) {</span>
<span class="nc bnc" id="L712" title="All 2 branches missed.">          if (board[xB][yB].getPiece() instanceof Bishop</span>
<span class="nc bnc" id="L713" title="All 2 branches missed.">              &amp;&amp; board[xB][yB].getPiece().getColor() == 0) {</span>
<span class="nc" id="L714">            b = (Bishop) board[xB][yB].getPiece();</span>
<span class="nc" id="L715">            board[xB][yB].setEmpty();</span>
<span class="nc" id="L716">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L717" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L718">              board[xB][yB].setPiece(b);</span>
<span class="nc" id="L719">              board[x][y].setEmpty();</span>
<span class="nc" id="L720">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L723">              movesDone.add(move);</span>
<span class="nc" id="L724">              blackTurn = false;</span>
<span class="nc" id="L725">              piecesAndCell[0] = b.toString();</span>
<span class="nc" id="L726">              piecesAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L727">              return piecesAndCell;</span>
            }
<span class="nc bnc" id="L729" title="All 2 branches missed.">          } else if (board[xB][yB].getPiece() != null) {</span>
<span class="nc" id="L730">            break;</span>
          } else {
<span class="nc" id="L732">            xB++;</span>
<span class="nc" id="L733">            yB++;</span>
          }
        }
<span class="nc" id="L736">        throw new IllegalMoveException(&quot;Mossa illegale, l'alfiere non puo' muoversi qui&quot;);</span>
      } else
<span class="nc" id="L738">        throw new IllegalMoveException(&quot;Mossa illegale, la cella di destinazione non e' vuota&quot;);</span>

    } else { // else per il caso di turno dei pezzi neri
<span class="nc bnc" id="L741" title="All 2 branches missed.">      if (board[x][y].getPiece() == null) {</span>
<span class="nc" id="L742">        xB = x - 1;</span>
<span class="nc" id="L743">        yB = y - 1;</span>
<span class="nc bnc" id="L744" title="All 4 branches missed.">        while (xB &gt;= 0 &amp;&amp; yB &gt;= 0) {</span>
<span class="nc bnc" id="L745" title="All 2 branches missed.">          if (board[xB][yB].getPiece() instanceof Bishop</span>
<span class="nc bnc" id="L746" title="All 2 branches missed.">              &amp;&amp; board[xB][yB].getPiece().getColor() == 1) {</span>
<span class="nc" id="L747">            b = (Bishop) board[xB][yB].getPiece();</span>
<span class="nc" id="L748">            board[xB][yB].setEmpty();</span>
<span class="nc" id="L749">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L750" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L751">              board[xB][yB].setPiece(b);</span>
<span class="nc" id="L752">              board[x][y].setEmpty();</span>
<span class="nc" id="L753">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L756">              movesDone.add(move);</span>
<span class="nc" id="L757">              blackTurn = true;</span>
<span class="nc" id="L758">              piecesAndCell[0] = b.toString();</span>
<span class="nc" id="L759">              piecesAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L760">              return piecesAndCell;</span>
            }
<span class="nc bnc" id="L762" title="All 2 branches missed.">          } else if (board[xB][yB].getPiece() != null) {</span>
<span class="nc" id="L763">            break;</span>
          } else {
<span class="nc" id="L765">            xB--;</span>
<span class="nc" id="L766">            yB--;</span>
          }
        }
<span class="nc" id="L769">        xB = x - 1;</span>
<span class="nc" id="L770">        yB = y + 1;</span>
<span class="nc bnc" id="L771" title="All 4 branches missed.">        while (xB &gt;= 0 &amp;&amp; yB &lt; 8) {</span>
<span class="nc bnc" id="L772" title="All 2 branches missed.">          if (board[xB][yB].getPiece() instanceof Bishop</span>
<span class="nc bnc" id="L773" title="All 2 branches missed.">              &amp;&amp; board[xB][yB].getPiece().getColor() == 1) {</span>
<span class="nc" id="L774">            b = (Bishop) board[xB][yB].getPiece();</span>
<span class="nc" id="L775">            board[xB][yB].setEmpty();</span>
<span class="nc" id="L776">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L777" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L778">              board[xB][yB].setPiece(b);</span>
<span class="nc" id="L779">              board[x][y].setEmpty();</span>
<span class="nc" id="L780">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L783">              movesDone.add(move);</span>
<span class="nc" id="L784">              blackTurn = true;</span>
<span class="nc" id="L785">              piecesAndCell[0] = b.toString();</span>
<span class="nc" id="L786">              piecesAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L787">              return piecesAndCell;</span>
            }
<span class="nc bnc" id="L789" title="All 2 branches missed.">          } else if (board[xB][yB].getPiece() != null) {</span>
<span class="nc" id="L790">            break;</span>
          } else {
<span class="nc" id="L792">            xB--;</span>
<span class="nc" id="L793">            yB++;</span>
          }
        }
<span class="nc" id="L796">        xB = x + 1;</span>
<span class="nc" id="L797">        yB = y - 1;</span>
<span class="nc bnc" id="L798" title="All 4 branches missed.">        while (xB &lt; 8 &amp;&amp; yB &gt;= 0) {</span>
<span class="nc bnc" id="L799" title="All 2 branches missed.">          if (board[xB][yB].getPiece() instanceof Bishop</span>
<span class="nc bnc" id="L800" title="All 2 branches missed.">              &amp;&amp; board[xB][yB].getPiece().getColor() == 1) {</span>
<span class="nc" id="L801">            b = (Bishop) board[xB][yB].getPiece();</span>
<span class="nc" id="L802">            board[xB][yB].setEmpty();</span>
<span class="nc" id="L803">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L804" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L805">              board[xB][yB].setPiece(b);</span>
<span class="nc" id="L806">              board[x][y].setEmpty();</span>
<span class="nc" id="L807">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L810">              movesDone.add(move);</span>
<span class="nc" id="L811">              blackTurn = true;</span>
<span class="nc" id="L812">              piecesAndCell[0] = b.toString();</span>
<span class="nc" id="L813">              piecesAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L814">              return piecesAndCell;</span>
            }
<span class="nc bnc" id="L816" title="All 2 branches missed.">          } else if (board[xB][yB].getPiece() != null) {</span>
<span class="nc" id="L817">            break;</span>
          } else {
<span class="nc" id="L819">            xB++;</span>
<span class="nc" id="L820">            yB--;</span>
          }
        }
<span class="nc" id="L823">        xB = x + 1;</span>
<span class="nc" id="L824">        yB = y + 1;</span>
<span class="nc bnc" id="L825" title="All 4 branches missed.">        while (xB &lt; 8 &amp;&amp; yB &lt; 8) {</span>
<span class="nc bnc" id="L826" title="All 2 branches missed.">          if (board[xB][yB].getPiece() instanceof Bishop</span>
<span class="nc bnc" id="L827" title="All 2 branches missed.">              &amp;&amp; board[xB][yB].getPiece().getColor() == 1) {</span>
<span class="nc" id="L828">            b = (Bishop) board[xB][yB].getPiece();</span>
<span class="nc" id="L829">            board[xB][yB].setEmpty();</span>
<span class="nc" id="L830">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L831" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L832">              board[xB][yB].setPiece(b);</span>
<span class="nc" id="L833">              board[x][y].setEmpty();</span>
<span class="nc" id="L834">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>

            } else {
<span class="nc" id="L837">              movesDone.add(move);</span>
<span class="nc" id="L838">              blackTurn = true;</span>
<span class="nc" id="L839">              piecesAndCell[0] = b.toString();</span>
<span class="nc" id="L840">              piecesAndCell[2] = move.substring(1, 3);</span>
<span class="nc" id="L841">              return piecesAndCell;</span>
            }
<span class="nc bnc" id="L843" title="All 2 branches missed.">          } else if (board[xB][yB].getPiece() != null) {</span>
<span class="nc" id="L844">            break;</span>
          } else {
<span class="nc" id="L846">            xB++;</span>
<span class="nc" id="L847">            yB++;</span>
          }
        }
<span class="nc" id="L850">        throw new IllegalMoveException(&quot;Mossa illegale, l'alfiere non puo' muoversi qui&quot;);</span>
      } else
<span class="nc" id="L852">        throw new IllegalMoveException(&quot;Mossa illegale, la cella di destinazione non e' vuota&quot;);</span>
    }
  }

  String[] captureBishop(String move) throws IllegalMoveException {
    int x;
    int y;
    int xb;
    int yb;
    Bishop b;
    Piece caught;
<span class="nc" id="L863">    String pieces[] = new String[3];</span>

<span class="nc" id="L865">    y = (int) move.charAt(2) - 97;</span>
<span class="nc" id="L866">    x = 8 - Integer.parseInt(move.substring(3, 4));</span>
<span class="nc bnc" id="L867" title="All 2 branches missed.">    if (blackTurn == true) { // controlli per bianchi</span>
<span class="nc bnc" id="L868" title="All 2 branches missed.">      if (board[x][y].getPiece() != null) {</span>
<span class="nc" id="L869">        xb = x - 1;</span>
<span class="nc" id="L870">        yb = y - 1;</span>
<span class="nc bnc" id="L871" title="All 4 branches missed.">        while (xb &gt;= 0 &amp;&amp; yb &gt;= 0) {</span>
<span class="nc bnc" id="L872" title="All 2 branches missed.">          if ((board[xb][yb].getPiece() instanceof Bishop)</span>
<span class="nc bnc" id="L873" title="All 2 branches missed.">              &amp;&amp; (board[xb][yb].getPiece().getColor() == 0)</span>
<span class="nc bnc" id="L874" title="All 2 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() == 1)) {</span>
<span class="nc" id="L875">            b = (Bishop) board[xb][yb].getPiece();</span>
<span class="nc" id="L876">            caught = board[x][y].getPiece();</span>
<span class="nc" id="L877">            pieces[0] = b.toString();</span>
<span class="nc" id="L878">            pieces[1] =caught.toString();</span>
<span class="nc" id="L879">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L880">            board[xb][yb].setEmpty();</span>
<span class="nc" id="L881">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L882" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L883">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L884">              board[xb][yb].setPiece(b);</span>
<span class="nc" id="L885">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L887">              BlacksCaptured.add(caught.toString());</span>
<span class="nc" id="L888">              movesDone.add(move);</span>
<span class="nc" id="L889">              blackTurn = false;</span>
<span class="nc" id="L890">              return pieces;</span>
            }
<span class="nc bnc" id="L892" title="All 2 branches missed.">          } else if (board[xb][yb].getPiece() != null) {</span>
<span class="nc" id="L893">            break;</span>
          } else {
<span class="nc" id="L895">            xb--;</span>
<span class="nc" id="L896">            yb--;</span>
          }
        }
<span class="nc" id="L899">        xb = x - 1;</span>
<span class="nc" id="L900">        yb = y + 1;</span>
<span class="nc bnc" id="L901" title="All 4 branches missed.">        while (xb &gt;= 0 &amp;&amp; yb &lt; 8) {</span>
<span class="nc bnc" id="L902" title="All 2 branches missed.">          if ((board[xb][yb].getPiece() instanceof Bishop)</span>
<span class="nc bnc" id="L903" title="All 2 branches missed.">              &amp;&amp; (board[xb][yb].getPiece().getColor() == 0)</span>
<span class="nc bnc" id="L904" title="All 2 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() == 1)) {</span>
<span class="nc" id="L905">            b = (Bishop) board[xb][yb].getPiece();</span>
<span class="nc" id="L906">            caught = board[x][y].getPiece();</span>
<span class="nc" id="L907">            pieces[0] = b.toString();</span>
<span class="nc" id="L908">            pieces[1] =caught.toString();</span>
<span class="nc" id="L909">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L910">            board[xb][yb].setEmpty();</span>
<span class="nc" id="L911">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L912" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L913">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L914">              board[xb][yb].setPiece(b);</span>
<span class="nc" id="L915">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L917">              BlacksCaptured.add(caught.toString());</span>
<span class="nc" id="L918">              movesDone.add(move);</span>
<span class="nc" id="L919">              blackTurn = false;</span>
<span class="nc" id="L920">              return pieces;</span>
            }
<span class="nc bnc" id="L922" title="All 2 branches missed.">          } else if (board[xb][yb].getPiece() != null) {</span>
<span class="nc" id="L923">            break;</span>
          } else {
<span class="nc" id="L925">            xb--;</span>
<span class="nc" id="L926">            yb++;</span>
          }
        }
<span class="nc" id="L929">        xb = x + 1;</span>
<span class="nc" id="L930">        yb = y - 1;</span>
<span class="nc bnc" id="L931" title="All 4 branches missed.">        while (xb &lt; 8 &amp;&amp; yb &gt;= 0) {</span>
<span class="nc bnc" id="L932" title="All 2 branches missed.">          if ((board[xb][yb].getPiece() instanceof Bishop)</span>
<span class="nc bnc" id="L933" title="All 2 branches missed.">              &amp;&amp; (board[xb][yb].getPiece().getColor() == 0)</span>
<span class="nc bnc" id="L934" title="All 2 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() == 1)) {</span>
<span class="nc" id="L935">            b = (Bishop) board[xb][yb].getPiece();</span>
<span class="nc" id="L936">            caught = board[x][y].getPiece();</span>
<span class="nc" id="L937">            pieces[0] = b.toString();</span>
<span class="nc" id="L938">            pieces[1] =caught.toString();</span>
<span class="nc" id="L939">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L940">            board[xb][yb].setEmpty();</span>
<span class="nc" id="L941">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L942" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L943">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L944">              board[xb][yb].setPiece(b);</span>
<span class="nc" id="L945">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L947">              BlacksCaptured.add(caught.toString());</span>
<span class="nc" id="L948">              movesDone.add(move);</span>
<span class="nc" id="L949">              blackTurn = false;</span>
<span class="nc" id="L950">              return pieces;</span>
            }
<span class="nc bnc" id="L952" title="All 2 branches missed.">          } else if (board[xb][yb].getPiece() != null) {</span>
<span class="nc" id="L953">            break;</span>
          } else {
<span class="nc" id="L955">            xb++;</span>
<span class="nc" id="L956">            yb--;</span>
          }
        }

<span class="nc" id="L960">        xb = x + 1;</span>
<span class="nc" id="L961">        yb = y + 1;</span>
<span class="nc bnc" id="L962" title="All 4 branches missed.">        while (xb &lt; 8 &amp;&amp; yb &lt; 8) {</span>
<span class="nc bnc" id="L963" title="All 2 branches missed.">          if ((board[xb][yb].getPiece() instanceof Bishop)</span>
<span class="nc bnc" id="L964" title="All 2 branches missed.">              &amp;&amp; (board[xb][yb].getPiece().getColor() == 0)</span>
<span class="nc bnc" id="L965" title="All 2 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() == 1)) {</span>
<span class="nc" id="L966">            b = (Bishop) board[xb][yb].getPiece();</span>
<span class="nc" id="L967">            caught = board[x][y].getPiece();</span>
<span class="nc" id="L968">            pieces[0] = b.toString();</span>
<span class="nc" id="L969">            pieces[1] =caught.toString();</span>
<span class="nc" id="L970">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L971">            board[xb][yb].setEmpty();</span>
<span class="nc" id="L972">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L973" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L974">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L975">              board[xb][yb].setPiece(b);</span>
<span class="nc" id="L976">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L978">              BlacksCaptured.add(caught.toString());</span>
<span class="nc" id="L979">              movesDone.add(move);</span>
<span class="nc" id="L980">              blackTurn = false;</span>
<span class="nc" id="L981">              return pieces;</span>
            }
<span class="nc bnc" id="L983" title="All 2 branches missed.">          } else if (board[xb][yb].getPiece() != null) {</span>
<span class="nc" id="L984">            break;</span>
          } else {
<span class="nc" id="L986">            xb++;</span>
<span class="nc" id="L987">            yb++;</span>
          }
        }
<span class="nc" id="L990">        throw new IllegalMoveException(&quot;Mossa illegale, l'alfiere non puo' catturare qui&quot;);</span>
<span class="nc" id="L991">      } else throw new IllegalMoveException(&quot;Mossa illegale, la cella di destinazione e' vuota&quot;);</span>

    } else { // controlli per i pezzi neri
<span class="nc bnc" id="L994" title="All 2 branches missed.">      if (board[x][y].getPiece() != null) {</span>
<span class="nc" id="L995">        xb = x - 1;</span>
<span class="nc" id="L996">        yb = y - 1;</span>
<span class="nc bnc" id="L997" title="All 4 branches missed.">        while (xb &gt;= 0 &amp;&amp; yb &gt;= 0) {</span>
<span class="nc bnc" id="L998" title="All 2 branches missed.">          if ((board[xb][yb].getPiece() instanceof Bishop)</span>
<span class="nc bnc" id="L999" title="All 2 branches missed.">              &amp;&amp; (board[xb][yb].getPiece().getColor() == 1)</span>
<span class="nc bnc" id="L1000" title="All 2 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() == 0)) {</span>
<span class="nc" id="L1001">            b = (Bishop) board[xb][yb].getPiece();</span>
<span class="nc" id="L1002">            caught = board[x][y].getPiece();</span>
<span class="nc" id="L1003">            pieces[0] = b.toString();</span>
<span class="nc" id="L1004">            pieces[1] =caught.toString();</span>
<span class="nc" id="L1005">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L1006">            board[xb][yb].setEmpty();</span>
<span class="nc" id="L1007">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L1008" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L1009">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L1010">              board[xb][yb].setPiece(b);</span>
<span class="nc" id="L1011">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L1013">              WhitesCaptured.add(caught.toString());</span>
<span class="nc" id="L1014">              movesDone.add(move);</span>
<span class="nc" id="L1015">              blackTurn = true;</span>
<span class="nc" id="L1016">              return pieces;</span>
            }
<span class="nc bnc" id="L1018" title="All 2 branches missed.">          } else if (board[xb][yb].getPiece() != null) {</span>
<span class="nc" id="L1019">            break;</span>
          } else {
<span class="nc" id="L1021">            xb--;</span>
<span class="nc" id="L1022">            yb--;</span>
          }
        }
<span class="nc" id="L1025">        xb = x - 1;</span>
<span class="nc" id="L1026">        yb = y + 1;</span>
<span class="nc bnc" id="L1027" title="All 4 branches missed.">        while (xb &gt;= 0 &amp;&amp; yb &lt; 8) {</span>
<span class="nc bnc" id="L1028" title="All 2 branches missed.">          if ((board[xb][yb].getPiece() instanceof Bishop)</span>
<span class="nc bnc" id="L1029" title="All 2 branches missed.">              &amp;&amp; (board[xb][yb].getPiece().getColor() == 1)</span>
<span class="nc bnc" id="L1030" title="All 2 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() == 0)) {</span>
<span class="nc" id="L1031">            b = (Bishop) board[xb][yb].getPiece();</span>
<span class="nc" id="L1032">            caught = board[x][y].getPiece();</span>
<span class="nc" id="L1033">            pieces[0] = b.toString();</span>
<span class="nc" id="L1034">            pieces[1] =caught.toString();</span>
<span class="nc" id="L1035">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L1036">            board[xb][yb].setEmpty();</span>
<span class="nc" id="L1037">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L1038" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L1039">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L1040">              board[xb][yb].setPiece(b);</span>
<span class="nc" id="L1041">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L1043">              WhitesCaptured.add(caught.toString());</span>
<span class="nc" id="L1044">              movesDone.add(move);</span>
<span class="nc" id="L1045">              blackTurn = true;</span>
<span class="nc" id="L1046">              return pieces;</span>
            }
<span class="nc bnc" id="L1048" title="All 2 branches missed.">          } else if (board[xb][yb].getPiece() != null) {</span>
<span class="nc" id="L1049">            break;</span>
          } else {
<span class="nc" id="L1051">            xb--;</span>
<span class="nc" id="L1052">            yb++;</span>
          }
        }
<span class="nc" id="L1055">        xb = x + 1;</span>
<span class="nc" id="L1056">        yb = y - 1;</span>
<span class="nc bnc" id="L1057" title="All 4 branches missed.">        while (xb &lt; 8 &amp;&amp; yb &gt;= 0) {</span>
<span class="nc bnc" id="L1058" title="All 2 branches missed.">          if ((board[xb][yb].getPiece() instanceof Bishop)</span>
<span class="nc bnc" id="L1059" title="All 2 branches missed.">              &amp;&amp; (board[xb][yb].getPiece().getColor() == 1)</span>
<span class="nc bnc" id="L1060" title="All 2 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() == 0)) {</span>
<span class="nc" id="L1061">            b = (Bishop) board[xb][yb].getPiece();</span>
<span class="nc" id="L1062">            caught = board[x][y].getPiece();</span>
<span class="nc" id="L1063">            pieces[0] = b.toString();</span>
<span class="nc" id="L1064">            pieces[1] =caught.toString();</span>
<span class="nc" id="L1065">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L1066">            board[xb][yb].setEmpty();</span>
<span class="nc" id="L1067">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L1068" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L1069">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L1070">              board[xb][yb].setPiece(b);</span>
<span class="nc" id="L1071">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L1073">              WhitesCaptured.add(caught.toString());</span>
<span class="nc" id="L1074">              movesDone.add(move);</span>
<span class="nc" id="L1075">              blackTurn = true;</span>
<span class="nc" id="L1076">              return pieces;</span>
            }
<span class="nc bnc" id="L1078" title="All 2 branches missed.">          } else if (board[xb][yb].getPiece() != null) {</span>
<span class="nc" id="L1079">            break;</span>
          } else {
<span class="nc" id="L1081">            xb++;</span>
<span class="nc" id="L1082">            yb--;</span>
          }
        }

<span class="nc" id="L1086">        xb = x + 1;</span>
<span class="nc" id="L1087">        yb = y + 1;</span>
<span class="nc bnc" id="L1088" title="All 4 branches missed.">        while (xb &lt; 8 &amp;&amp; yb &lt; 8) {</span>
<span class="nc bnc" id="L1089" title="All 2 branches missed.">          if ((board[xb][yb].getPiece() instanceof Bishop)</span>
<span class="nc bnc" id="L1090" title="All 2 branches missed.">              &amp;&amp; (board[xb][yb].getPiece().getColor() == 1)</span>
<span class="nc bnc" id="L1091" title="All 2 branches missed.">              &amp;&amp; (board[x][y].getPiece().getColor() == 0)) {</span>
<span class="nc" id="L1092">            b = (Bishop) board[xb][yb].getPiece();</span>
<span class="nc" id="L1093">            caught = board[x][y].getPiece();</span>
<span class="nc" id="L1094">            pieces[0] = b.toString();</span>
<span class="nc" id="L1095">            pieces[1] =caught.toString();</span>
<span class="nc" id="L1096">            pieces[2] = move.substring(2, 4);</span>
<span class="nc" id="L1097">            board[xb][yb].setEmpty();</span>
<span class="nc" id="L1098">            board[x][y].setPiece(b);</span>
<span class="nc bnc" id="L1099" title="All 2 branches missed.">            if (King.isThreatened()) {</span>
<span class="nc" id="L1100">              board[x][y].setPiece(caught);</span>
<span class="nc" id="L1101">              board[xb][yb].setPiece(b);</span>
<span class="nc" id="L1102">              throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
            } else {
<span class="nc" id="L1104">              WhitesCaptured.add(caught.toString());</span>
<span class="nc" id="L1105">              movesDone.add(move);</span>
<span class="nc" id="L1106">              blackTurn = true;</span>
<span class="nc" id="L1107">              return pieces;</span>
            }
<span class="nc bnc" id="L1109" title="All 2 branches missed.">          } else if (board[xb][yb].getPiece() != null) {</span>
<span class="nc" id="L1110">            break;</span>
          } else {
<span class="nc" id="L1112">            xb++;</span>
<span class="nc" id="L1113">            yb++;</span>
          }
        }
<span class="nc" id="L1116">        throw new IllegalMoveException(&quot;Mossa illegale, l'alfiere non puo' catturare qui&quot;);</span>
<span class="nc" id="L1117">      } else throw new IllegalMoveException(&quot;Mossa illegale, la cella di destinazione e' vuota&quot;);</span>
    }
  }
  boolean isMovableKnight(int x, int y, int a, int b) {
<span class="nc bnc" id="L1121" title="All 4 branches missed.">    if ((Math.abs(x - a) == 1 &amp;&amp; Math.abs(y - b) == 2)</span>
<span class="nc bnc" id="L1122" title="All 4 branches missed.">        || (Math.abs(y - b) == 1 &amp;&amp; Math.abs(x - a) == 2)) {</span>
<span class="nc bnc" id="L1123" title="All 2 branches missed.">      if (board[a][b].getPiece() == null</span>
<span class="nc bnc" id="L1124" title="All 4 branches missed.">          || board[a][b].getPiece().getColor() == (blackTurn ? 1 : 0)) return true;</span>
    }
<span class="nc" id="L1126">    return false;</span>
  }

  String[] moveKnight(String move) throws IllegalMoveException {
<span class="nc" id="L1130">    int count = 0;</span>
<span class="nc" id="L1131">    String[] printOut = new String[2];</span>
<span class="nc" id="L1132">    int xC1 = -1, yC1 = -1, xC2 = -1, yC2 = -1;</span>
<span class="nc" id="L1133">    int a = 8 - Integer.parseInt(move.substring(move.length() - 1));</span>
<span class="nc" id="L1134">    int b = (int) move.charAt(move.length() - 2) - 97;</span>
<span class="nc bnc" id="L1135" title="All 2 branches missed.">    if (board[a][b].getPiece() != null</span>
<span class="nc bnc" id="L1136" title="All 4 branches missed.">        &amp;&amp; board[a][b].getPiece().getColor() != (blackTurn ? 1 : 0)) {</span>
<span class="nc" id="L1137">      throw new IllegalMoveException(&quot;Non puoi spostarti sulla cella di un alleato.&quot;);</span>
    }
<span class="nc bnc" id="L1139" title="All 2 branches missed.">    for (int i = 0; i &lt;= 7; i++) {</span>
<span class="nc bnc" id="L1140" title="All 2 branches missed.">      for (int j = 0; j &lt;= 7; j++) {</span>
<span class="nc bnc" id="L1141" title="All 2 branches missed.">        if (board[i][j].getPiece() instanceof Knight</span>
<span class="nc bnc" id="L1142" title="All 4 branches missed.">            &amp;&amp; board[i][j].getPiece().getColor() != (blackTurn ? 1 : 0)) {</span>
<span class="nc bnc" id="L1143" title="All 2 branches missed.">          if (xC1 == -1) {</span>
<span class="nc" id="L1144">            xC1 = i;</span>
<span class="nc" id="L1145">            yC1 = j;</span>
          } else {
<span class="nc" id="L1147">            xC2 = i;</span>
<span class="nc" id="L1148">            yC2 = j;</span>
          }
        }
      }
    }
<span class="nc bnc" id="L1153" title="All 4 branches missed.">    if (xC1 != -1 &amp;&amp; yC1 != -1) {</span>
<span class="nc bnc" id="L1154" title="All 2 branches missed.">      if (isMovableKnight(xC1, yC1, a, b)) {</span>
<span class="nc" id="L1155">        count = count + 1;</span>
      }
    }
<span class="nc bnc" id="L1158" title="All 4 branches missed.">    if (xC2 != -1 &amp;&amp; yC2 != -1) {</span>
<span class="nc bnc" id="L1159" title="All 2 branches missed.">      if (isMovableKnight(xC2, yC2, a, b)) {</span>
<span class="nc" id="L1160">        count = count + 2;</span>
      }
    }
<span class="nc bnc" id="L1163" title="All 2 branches missed.">    if (count == 0) {</span>
<span class="nc" id="L1164">      throw new IllegalMoveException(&quot;Nessun cavallo puo' spostarsi in quella cella.&quot;);</span>
    }

<span class="nc bnc" id="L1167" title="All 2 branches missed.">    if (count == 1) {</span>
<span class="nc bnc" id="L1168" title="All 2 branches missed.">      if (move.charAt(1) == 'x') {</span>
<span class="nc" id="L1169">        printOut[0] = board[a][b].getPiece().getType();</span>
<span class="nc" id="L1170">        printOut[1] = board[xC1][yC1].getPiece().getType();</span>
<span class="nc" id="L1171">        captureKnight(xC1, yC1, a, b, move);</span>
<span class="nc" id="L1172">        return printOut;</span>
<span class="nc bnc" id="L1173" title="All 4 branches missed.">      } else if (move.charAt(1) &gt;= 'a' &amp;&amp; move.charAt(1) &lt;= 'h') {</span>
<span class="nc" id="L1174">        actualMoveKnight(xC1, yC1, a, b, move);</span>
<span class="nc" id="L1175">        printOut[1] = board[a][b].getPiece().getType();</span>
<span class="nc" id="L1176">        return printOut;</span>
      } else {
<span class="nc" id="L1178">        throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
      }
<span class="nc bnc" id="L1180" title="All 2 branches missed.">    } else if (count == 2) {</span>
<span class="nc bnc" id="L1181" title="All 2 branches missed.">      if (move.charAt(1) == 'x') {</span>
<span class="nc" id="L1182">        printOut[0] = board[a][b].getPiece().getType();</span>
<span class="nc" id="L1183">        printOut[1] = board[xC2][yC2].getPiece().getType();</span>
<span class="nc" id="L1184">        captureKnight(xC2, yC2, a, b, move);</span>
<span class="nc" id="L1185">        return printOut;</span>
<span class="nc bnc" id="L1186" title="All 4 branches missed.">      } else if (move.charAt(1) &gt;= 'a' &amp;&amp; move.charAt(1) &lt;= 'h') {</span>
<span class="nc" id="L1187">        actualMoveKnight(xC2, yC2, a, b, move);</span>
<span class="nc" id="L1188">        printOut[1] = board[a][b].getPiece().getType();</span>
<span class="nc" id="L1189">        return printOut;</span>
      } else {
<span class="nc" id="L1191">        throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
      }
<span class="nc bnc" id="L1193" title="All 2 branches missed.">    } else if (count == 3) {</span>
<span class="nc bnc" id="L1194" title="All 2 branches missed.">      if (move.charAt(1) == 'x') {</span>
<span class="nc" id="L1195">        throw new IllegalMoveException(</span>
            &quot;Mossa ambigua, devi specificare quale dei due cavalli muovere secondo la notazione algebrica.&quot;);
      }
<span class="nc bnc" id="L1198" title="All 2 branches missed.">      if (move.length() == 3) {</span>
<span class="nc" id="L1199">        throw new IllegalMoveException(</span>
            &quot;Mossa ambigua, devi specificare quale dei due cavalli muovere secondo la notazione algebrica.&quot;);
      }

      int x, y;
<span class="nc bnc" id="L1204" title="All 4 branches missed.">      if (move.charAt(1) &gt;= '1' &amp;&amp; move.charAt(1) &lt;= '8') {</span>
<span class="nc bnc" id="L1205" title="All 2 branches missed.">        if (xC1 == xC2) {</span>
<span class="nc" id="L1206">          throw new IllegalMoveException(</span>
              &quot;Quando i due cavalli si trovano sulla stessa riga e' necessario specificare la colonna!&quot;);
        }
<span class="nc bnc" id="L1209" title="All 2 branches missed.">        if (xC1 == (8 - Integer.parseInt(move.substring(1, 2)))) {</span>
<span class="nc" id="L1210">          x = xC1;</span>
<span class="nc" id="L1211">          y = yC1;</span>
<span class="nc bnc" id="L1212" title="All 2 branches missed.">        } else if (xC2 == (8 - Integer.parseInt(move.substring(1, 2)))) {</span>
<span class="nc" id="L1213">          x = xC2;</span>
<span class="nc" id="L1214">          y = yC2;</span>
        } else {
<span class="nc" id="L1216">          throw new IllegalMoveException(</span>
              &quot;Nessun cavallo appartenente alla riga di disambiguazione specificata.&quot;);
        }
<span class="nc bnc" id="L1219" title="All 2 branches missed.">        if (move.length() == 4) {</span>
<span class="nc" id="L1220">          actualMoveKnight(x, y, a, b, move);</span>
<span class="nc" id="L1221">          printOut[1] = board[a][b].getPiece().getType();</span>
<span class="nc" id="L1222">          return printOut;</span>
<span class="nc bnc" id="L1223" title="All 2 branches missed.">        } else if (move.length() == 5) {</span>
<span class="nc" id="L1224">          printOut[0] = board[a][b].getPiece().getType();</span>
<span class="nc" id="L1225">          printOut[1] = board[x][y].getPiece().getType();</span>
<span class="nc" id="L1226">          captureKnight(x, y, a, b, move);</span>
<span class="nc" id="L1227">          return printOut;</span>
        } else {
<span class="nc" id="L1229">          throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
        }
<span class="nc bnc" id="L1231" title="All 4 branches missed.">      } else if (move.charAt(1) &gt;= 'a' &amp;&amp; move.charAt(1) &lt;= 'h') {</span>
<span class="nc bnc" id="L1232" title="All 2 branches missed.">        if (yC1 == yC2) {</span>
<span class="nc" id="L1233">          throw new IllegalMoveException(</span>
              &quot;Quando i due cavalli si trovano sulla stessa colonna e' necessario specificare la riga!&quot;);
        }
<span class="nc bnc" id="L1236" title="All 2 branches missed.">        if (yC1 == ((int) move.charAt(1) - 97)) {</span>
<span class="nc" id="L1237">          x = xC1;</span>
<span class="nc" id="L1238">          y = yC1;</span>
<span class="nc bnc" id="L1239" title="All 2 branches missed.">        } else if (yC2 == ((int) move.charAt(1) - 97)) {</span>
<span class="nc" id="L1240">          x = xC2;</span>
<span class="nc" id="L1241">          y = yC2;</span>
        } else {
<span class="nc" id="L1243">          throw new IllegalMoveException(</span>
              &quot;Nessun cavallo appartenente alla colonna di disambiguazione specificata.&quot;);
        }
<span class="nc bnc" id="L1246" title="All 2 branches missed.">        if (move.length() == 4) {</span>
<span class="nc" id="L1247">          actualMoveKnight(x, y, a, b, move);</span>
<span class="nc" id="L1248">          printOut[1] = board[a][b].getPiece().getType();</span>
<span class="nc" id="L1249">          return printOut;</span>
<span class="nc bnc" id="L1250" title="All 2 branches missed.">        } else if (move.length() == 5) {</span>
<span class="nc" id="L1251">          printOut[0] = board[a][b].getPiece().getType();</span>
<span class="nc" id="L1252">          printOut[1] = board[x][y].getPiece().getType();</span>
<span class="nc" id="L1253">          captureKnight(x, y, a, b, move);</span>
<span class="nc" id="L1254">          return printOut;</span>
        } else {
<span class="nc" id="L1256">          throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
        }
      } else {
<span class="nc" id="L1259">        throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
      }
    }

<span class="nc" id="L1263">    return printOut;</span>
  }

  void actualMoveKnight(int xC, int yC, int x, int y, String move) throws IllegalMoveException {
<span class="nc bnc" id="L1267" title="All 2 branches missed.">    if (board[x][y].getPiece() != null</span>
<span class="nc bnc" id="L1268" title="All 4 branches missed.">        &amp;&amp; board[x][y].getPiece().getColor() == (blackTurn ? 1 : 0)) {</span>
<span class="nc" id="L1269">      throw new IllegalMoveException(</span>
          &quot;Mossa non valida, devi specificare la cattura come da notazione algebrica.&quot;);
    }
<span class="nc bnc" id="L1272" title="All 2 branches missed.">    if (blackTurn == true) {</span>
<span class="nc" id="L1273">    	 board[x][y].setPiece(board[xC][yC].getPiece());</span>
<span class="nc" id="L1274">    	 board[xC][yC].setEmpty();</span>
<span class="nc bnc" id="L1275" title="All 2 branches missed.">      if (King.isThreatened()) {</span>
<span class="nc" id="L1276">    	  board[xC][yC].setPiece(board[x][y].getPiece());</span>
<span class="nc" id="L1277">    	  board[x][y].setEmpty();</span>
<span class="nc" id="L1278">        throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
      }
    } else {
<span class="nc" id="L1281">    	 board[x][y].setPiece(board[xC][yC].getPiece());</span>
<span class="nc" id="L1282">    	 board[xC][yC].setEmpty();</span>
<span class="nc bnc" id="L1283" title="All 2 branches missed.">      if (King.isThreatened()) {</span>
<span class="nc" id="L1284">    	  board[xC][yC].setPiece(board[x][y].getPiece());</span>
<span class="nc" id="L1285">    	  board[x][y].setEmpty();</span>
<span class="nc" id="L1286">        throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
      }
    }
    
<span class="nc" id="L1290">    movesDone.add(move);</span>
<span class="nc bnc" id="L1291" title="All 2 branches missed.">    blackTurn = !blackTurn;</span>
<span class="nc" id="L1292">  }</span>

  void captureKnight(int xC, int yC, int x, int y, String move) throws IllegalMoveException {
<span class="nc bnc" id="L1295" title="All 2 branches missed.">    if (board[x][y].getPiece() == null) {</span>
<span class="nc" id="L1296">      throw new IllegalMoveException(&quot;Mossa non valida, non c'e' nessun pezzo da catturare.&quot;);</span>
    }
<span class="nc bnc" id="L1298" title="All 2 branches missed.">    if (board[x][y].getPiece().getColor() == 0) {</span>
<span class="nc" id="L1299">      WhitesCaptured.add(board[x][y].getPiece().toString());</span>
    } else {
<span class="nc" id="L1301">      BlacksCaptured.add(board[x][y].getPiece().toString());</span>
    }
<span class="nc" id="L1303">    board[x][y].setPiece(board[xC][yC].getPiece());</span>
<span class="nc" id="L1304">    board[xC][yC].setEmpty();</span>
<span class="nc" id="L1305">    movesDone.add(move);</span>
<span class="nc bnc" id="L1306" title="All 2 branches missed.">    blackTurn = !blackTurn;</span>
<span class="nc" id="L1307">  }</span>

  boolean isMovableRook(int x, int y, int a, int b) {
    int i;

<span class="nc bnc" id="L1312" title="All 4 branches missed.">    if (x == a &amp;&amp; y == b) return false;</span>

<span class="nc bnc" id="L1314" title="All 2 branches missed.">    if (x == a) { // controllo orizzontale</span>
<span class="nc bnc" id="L1315" title="All 2 branches missed.">      int dx = (y &lt; b) ? 1 : -1;</span>

<span class="nc bnc" id="L1317" title="All 4 branches missed.">      for (i = y + dx; i != b; i += dx) if (board[x][i].getPiece() != null) return false;</span>
<span class="nc bnc" id="L1318" title="All 2 branches missed.">    } else if (y == b) { // in verticale</span>
<span class="nc bnc" id="L1319" title="All 2 branches missed.">      int dy = (x &lt; a) ? 1 : -1;</span>

<span class="nc bnc" id="L1321" title="All 4 branches missed.">      for (i = x + dy; i != a; i += dy) if (board[i][y].getPiece() != null) return false;</span>
<span class="nc" id="L1322">    } else { // Non valido</span>
<span class="nc" id="L1323">      return false;</span>
    }

    // Return true
<span class="nc" id="L1327">    return true;</span>
  }

  String[] moveRook(String move) throws IllegalMoveException {
<span class="nc" id="L1331">	    int count = 0;</span>
<span class="nc" id="L1332">	    int xC1 = -1;</span>
<span class="nc" id="L1333">	    int yC1 = -1;</span>
<span class="nc" id="L1334">	    int xC2 = -1;</span>
<span class="nc" id="L1335">	    int yC2 = -1;</span>
<span class="nc" id="L1336">	    String[] piecesAndCell=new String[3];</span>
	    
<span class="nc" id="L1338">	    int a = 8 - Integer.parseInt(move.substring(move.length() - 1));</span>
<span class="nc" id="L1339">	    int b = (int) move.charAt(move.length() - 2) - 97;</span>
	    
<span class="nc bnc" id="L1341" title="All 2 branches missed.">	    if (board[a][b].getPiece() != null</span>
<span class="nc bnc" id="L1342" title="All 4 branches missed.">	        &amp;&amp; board[a][b].getPiece().getColor() != (blackTurn ? 1 : 0)) {</span>
<span class="nc" id="L1343">	      throw new IllegalMoveException(&quot;Non puoi spostarti sulla cella di un alleato.&quot;);</span>
	    }
	    
<span class="nc bnc" id="L1346" title="All 2 branches missed.">	    for (int i = 0; i &lt;= 7; i++) {</span>
<span class="nc bnc" id="L1347" title="All 2 branches missed.">	      for (int j = 0; j &lt;= 7; j++) {</span>
<span class="nc bnc" id="L1348" title="All 2 branches missed.">	        if (board[i][j].getPiece() instanceof Rook</span>
<span class="nc bnc" id="L1349" title="All 4 branches missed.">	            &amp;&amp; board[i][j].getPiece().getColor() != (blackTurn ? 1 : 0)) {</span>
<span class="nc bnc" id="L1350" title="All 2 branches missed.">	          if (xC1 == -1) {</span>
<span class="nc" id="L1351">	            xC1 = i;</span>
<span class="nc" id="L1352">	            yC1 = j;</span>
	          } else {
<span class="nc" id="L1354">	            xC2 = i;</span>
<span class="nc" id="L1355">	            yC2 = j;</span>
	          }
	        }
	      }
	    }
<span class="nc bnc" id="L1360" title="All 4 branches missed.">	    if (xC1 != -1 &amp;&amp; yC1 != -1) {</span>
<span class="nc bnc" id="L1361" title="All 2 branches missed.">	      if (isMovableRook(xC1, yC1, a, b)) {</span>
<span class="nc" id="L1362">	        count = count + 1;</span>
	      }
	    }
<span class="nc bnc" id="L1365" title="All 4 branches missed.">	    if (xC2 != -1 &amp;&amp; yC2 != -1) {</span>
<span class="nc bnc" id="L1366" title="All 2 branches missed.">	      if (isMovableRook(xC2, yC2, a, b)) {</span>
<span class="nc" id="L1367">	        count = count + 2;</span>
	      }
	    }

<span class="nc bnc" id="L1371" title="All 2 branches missed.">	    if (count == 0) {</span>
<span class="nc" id="L1372">	      throw new IllegalMoveException(&quot;Nessuna torre puo' spostarsi in quella cella.&quot;);</span>
	    }

<span class="nc bnc" id="L1375" title="All 2 branches missed.">	    if (count == 1) {</span>
<span class="nc bnc" id="L1376" title="All 2 branches missed.">	      if (move.charAt(1) == 'x') {</span>
<span class="nc" id="L1377">	        piecesAndCell[1] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1378">	        piecesAndCell[0] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1379">	        piecesAndCell[2] = move.substring(2,4);</span>
<span class="nc" id="L1380">	        captureRook(xC1, yC1, a, b, move);</span>
<span class="nc" id="L1381">	        return piecesAndCell;</span>
<span class="nc bnc" id="L1382" title="All 4 branches missed.">	      } else if (move.charAt(1) &gt;= 'a' &amp;&amp; move.charAt(1) &lt;= 'h') {</span>
<span class="nc" id="L1383">	        actualMoveRook(xC1, yC1, a, b, move);</span>
<span class="nc" id="L1384">	        piecesAndCell[0] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1385">	        piecesAndCell[2] = move.substring(1,3);</span>
<span class="nc" id="L1386">	        return piecesAndCell;</span>
	      } else {
<span class="nc" id="L1388">	        throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
	      }
<span class="nc bnc" id="L1390" title="All 2 branches missed.">	    } else if (count == 2) {</span>
<span class="nc bnc" id="L1391" title="All 2 branches missed.">	      if (move.charAt(1) == 'x') {</span>
<span class="nc" id="L1392">	    	  piecesAndCell[1] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1393">	          piecesAndCell[0] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1394">	          piecesAndCell[2] = move.substring(2,4);</span>
<span class="nc" id="L1395">	        captureRook(xC2, yC2, a, b, move);</span>
<span class="nc" id="L1396">	        return piecesAndCell;</span>
<span class="nc bnc" id="L1397" title="All 4 branches missed.">	      } else if (move.charAt(1) &gt;= 'a' &amp;&amp; move.charAt(1) &lt;= 'h') {</span>
<span class="nc" id="L1398">	        actualMoveRook(xC2, yC2, a, b, move);</span>
<span class="nc" id="L1399">	        piecesAndCell[0] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1400">	        piecesAndCell[2] = move.substring(1,3);</span>
<span class="nc" id="L1401">	        return piecesAndCell;</span>
	      } else {
<span class="nc" id="L1403">	        throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
	      }
<span class="nc bnc" id="L1405" title="All 2 branches missed.">	    } else if (count == 3) {</span>
<span class="nc bnc" id="L1406" title="All 2 branches missed.">	      if (move.charAt(1) == 'x') {</span>
<span class="nc" id="L1407">	        throw new IllegalMoveException(</span>
	            &quot;Mossa ambigua, devi specificare quale delle due torri muovere secondo la notazione algebrica.&quot;);
	      }
<span class="nc bnc" id="L1410" title="All 2 branches missed.">	      if (move.length() == 3) {</span>
<span class="nc" id="L1411">	        throw new IllegalMoveException(</span>
	            &quot;Mossa ambigua, devi specificare quale delle due torri muovere secondo la notazione algebrica.&quot;);
	      }

	      int x, y;
<span class="nc bnc" id="L1416" title="All 4 branches missed.">	      if (move.charAt(1) &gt;= '1' &amp;&amp; move.charAt(1) &lt;= '8') {</span>
<span class="nc bnc" id="L1417" title="All 2 branches missed.">	        if (xC1 == xC2) {</span>
<span class="nc" id="L1418">	          throw new IllegalMoveException(</span>
	              &quot;Quando le due torri si trovano sulla stessa riga e' necessario specificare la colonna!&quot;);
	        }
<span class="nc bnc" id="L1421" title="All 2 branches missed.">	        if (xC1 == (8 - Integer.parseInt(move.substring(1, 2)))) {</span>
<span class="nc" id="L1422">	          x = xC1;</span>
<span class="nc" id="L1423">	          y = yC1;</span>
<span class="nc bnc" id="L1424" title="All 2 branches missed.">	        } else if (xC2 == (8 - Integer.parseInt(move.substring(1, 2)))) {</span>
<span class="nc" id="L1425">	          x = xC2;</span>
<span class="nc" id="L1426">	          y = yC2;</span>
	        } else {
<span class="nc" id="L1428">	          throw new IllegalMoveException(</span>
	              &quot;Nessuna torre appartenente alla riga di disambiguazione specificata.&quot;);
	        }
<span class="nc bnc" id="L1431" title="All 2 branches missed.">	        if (move.length() == 4) {</span>
<span class="nc" id="L1432">	          actualMoveRook(x, y, a, b, move);</span>
<span class="nc" id="L1433">	          piecesAndCell[0] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1434">	          piecesAndCell[2] = move.substring(1,3);</span>
<span class="nc" id="L1435">	          return piecesAndCell;</span>
<span class="nc bnc" id="L1436" title="All 2 branches missed.">	        } else if (move.length() == 5) {</span>
<span class="nc" id="L1437">	        	piecesAndCell[0] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1438">	            piecesAndCell[2] = move.substring(1,3);</span>
<span class="nc" id="L1439">	            captureRook(x, y, a, b, move);</span>
<span class="nc" id="L1440">	            return piecesAndCell;</span>
	            } else {
<span class="nc" id="L1442">	          throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
	        }
<span class="nc bnc" id="L1444" title="All 4 branches missed.">	      } else if (move.charAt(1) &gt;= 'a' &amp;&amp; move.charAt(1) &lt;= 'h') {</span>
<span class="nc bnc" id="L1445" title="All 2 branches missed.">	        if (yC1 == yC2) {</span>
<span class="nc" id="L1446">	          throw new IllegalMoveException(</span>
	              &quot;Quando le due torri si trovano sulla stessa colonna e' necessario specificare la riga!&quot;);
	        }
<span class="nc bnc" id="L1449" title="All 2 branches missed.">	        if (yC1 == ((int) move.charAt(1) - 97)) {</span>
<span class="nc" id="L1450">	          x = xC1;</span>
<span class="nc" id="L1451">	          y = yC1;</span>
<span class="nc bnc" id="L1452" title="All 2 branches missed.">	        } else if (yC2 == ((int) move.charAt(1) - 97)) {</span>
<span class="nc" id="L1453">	          x = xC2;</span>
<span class="nc" id="L1454">	          y = yC2;</span>
	        } else {
<span class="nc" id="L1456">	          throw new IllegalMoveException(</span>
	              &quot;Nessuna torre appartenente alla colonna di disambiguazione specificata.&quot;);
	        }
<span class="nc bnc" id="L1459" title="All 2 branches missed.">	        if (move.length() == 4) {</span>
<span class="nc" id="L1460">	          actualMoveRook(x, y, a, b, move);</span>
<span class="nc" id="L1461">	          piecesAndCell[0] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1462">	          piecesAndCell[2] = move.substring(1,3);</span>
<span class="nc" id="L1463">	          return piecesAndCell;</span>
<span class="nc bnc" id="L1464" title="All 2 branches missed.">	        } else if (move.length() == 5) {</span>
<span class="nc" id="L1465">	        	 piecesAndCell[1] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1466">	             piecesAndCell[0] = board[a][b].getPiece().toString();</span>
<span class="nc" id="L1467">	             piecesAndCell[2] = move.substring(2,4);</span>
<span class="nc" id="L1468">	          captureRook(x, y, a, b, move);</span>
<span class="nc" id="L1469">	          return piecesAndCell;</span>
	        } else {
<span class="nc" id="L1471">	          throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
	        }
	      } else {
<span class="nc" id="L1474">	        throw new IllegalMoveException(&quot;Mossa non riconosciuta.&quot;);</span>
	      }
	    }
<span class="nc" id="L1477">	    return piecesAndCell;</span>
	  }

  void actualMoveRook(int xC, int yC, int x, int y, String move) throws IllegalMoveException {
<span class="nc bnc" id="L1481" title="All 2 branches missed.">    if (board[x][y].getPiece() != null</span>
<span class="nc bnc" id="L1482" title="All 4 branches missed.">        &amp;&amp; board[x][y].getPiece().getColor() == (blackTurn ? 1 : 0)) {</span>
<span class="nc" id="L1483">      throw new IllegalMoveException(</span>
          &quot;Mossa non valida, devi specificare la cattura come da notazione algebrica.&quot;);
    }
<span class="nc bnc" id="L1486" title="All 2 branches missed.">    if (blackTurn==true) {</span>
<span class="nc" id="L1487">    board[x][y].setPiece(board[xC][yC].getPiece());</span>
<span class="nc" id="L1488">    board[xC][yC].setEmpty();</span>
<span class="nc bnc" id="L1489" title="All 2 branches missed.">    if(King.isThreatened()) {</span>
<span class="nc" id="L1490">      board[xC][yC].setPiece(board[x][y].getPiece());</span>
<span class="nc" id="L1491">  	  board[x][y].setEmpty();</span>
<span class="nc" id="L1492">      throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
    }
    } else {
<span class="nc" id="L1495">    	board[x][y].setPiece(board[xC][yC].getPiece());</span>
<span class="nc" id="L1496">   	    board[xC][yC].setEmpty();</span>
<span class="nc bnc" id="L1497" title="All 2 branches missed.">   	 if (King.isThreatened()) {</span>
<span class="nc" id="L1498">   	     board[xC][yC].setPiece(board[x][y].getPiece());</span>
<span class="nc" id="L1499">   	     board[x][y].setEmpty();</span>
<span class="nc" id="L1500">         throw new IllegalMoveException(&quot;Mossa illegale; Metterebbe il re sotto scacco&quot;);</span>
     }
   }
    
<span class="nc" id="L1504">    movesDone.add(move);</span>
<span class="nc" id="L1505">    ((Rook) board[x][y].getPiece()).incrementMoves();</span>
<span class="nc bnc" id="L1506" title="All 2 branches missed.">    blackTurn = !blackTurn;</span>
<span class="nc" id="L1507">  }</span>

  void captureRook(int xC, int yC, int x, int y, String move) throws IllegalMoveException {
<span class="nc bnc" id="L1510" title="All 2 branches missed.">    if (board[x][y].getPiece() == null) {</span>
<span class="nc" id="L1511">      throw new IllegalMoveException(&quot;Mossa non valida, non c'e' nessun pezzo da catturare.&quot;);</span>
    }
<span class="nc bnc" id="L1513" title="All 2 branches missed.">    if (board[x][y].getPiece().getColor() == 0) {</span>
<span class="nc" id="L1514">      WhitesCaptured.add(board[x][y].getPiece().toString());</span>
    } else {
<span class="nc" id="L1516">      BlacksCaptured.add(board[x][y].getPiece().toString());</span>
    }
<span class="nc" id="L1518">    board[x][y].setPiece(board[xC][yC].getPiece());</span>
<span class="nc" id="L1519">    board[xC][yC].setEmpty();</span>
<span class="nc" id="L1520">    movesDone.add(move);</span>
<span class="nc" id="L1521">    ((Rook) board[x][y].getPiece()).incrementMoves();</span>
<span class="nc bnc" id="L1522" title="All 2 branches missed.">    blackTurn = !blackTurn;</span>
<span class="nc" id="L1523">  }</span>

  String[] shortCastling() throws IllegalMoveException {
<span class="nc" id="L1526">    String[] result = new String[2];</span>
<span class="nc bnc" id="L1527" title="All 2 branches missed.">    if (blackTurn == true) {</span>
<span class="nc bnc" id="L1528" title="All 4 branches missed.">      if ((board[7][4].getPiece() instanceof King) &amp;&amp; (board[7][7].getPiece() instanceof Rook)) {</span>
        // controllo che re e torre siano nella posizione corretta
<span class="nc" id="L1530">        King k = (King) board[7][4].getPiece();</span>
<span class="nc" id="L1531">        Rook r = (Rook) board[7][7].getPiece();</span>
<span class="nc bnc" id="L1532" title="All 2 branches missed.">        if ((k.getNumberOfMoves() == 0)</span>
<span class="nc bnc" id="L1533" title="All 2 branches missed.">            &amp;&amp; (r.getNumberOfMoves() == 0)) { // controllo che non siano stati</span>
          // ancora mossi

<span class="nc bnc" id="L1536" title="All 2 branches missed.">          if ((board[7][5].getPiece() == null)</span>
<span class="nc bnc" id="L1537" title="All 2 branches missed.">              &amp;&amp; (board[7][6].getPiece() == null)) { // controllo se il</span>
            // percorso e' libero
<span class="nc bnc" id="L1539" title="All 2 branches missed.">            if ((King.isThreatened(7, 4))</span>
<span class="nc bnc" id="L1540" title="All 2 branches missed.">                || (King.isThreatened(7, 5))</span>
                // controllo che il re non e', e non finisce sotto scacco durante la mossa
<span class="nc bnc" id="L1542" title="All 2 branches missed.">                || (King.isThreatened(7, 6))) {</span>
<span class="nc" id="L1543">              throw new IllegalMoveException(</span>
                  &quot;Mossa illegale; Il re e' sotto scacco, o finirebbe sotto scacco effettuando l'arrocco&quot;);
            }
<span class="nc" id="L1546">            k.incrementMoves();</span>
<span class="nc" id="L1547">            r.incrementMoves();</span>
<span class="nc" id="L1548">            board[7][6].setPiece(k);</span>
<span class="nc" id="L1549">            board[7][5].setPiece(r);</span>
<span class="nc" id="L1550">            board[7][4].setEmpty();</span>
<span class="nc" id="L1551">            board[7][7].setEmpty();</span>
<span class="nc" id="L1552">            movesDone.add(&quot;0-0&quot;);</span>
<span class="nc" id="L1553">            blackTurn = false;</span>
<span class="nc" id="L1554">            result[0] = &quot;0-0&quot;;</span>
<span class="nc" id="L1555">            return result;</span>
          } else {
<span class="nc" id="L1557">            throw new IllegalMoveException(&quot;Mossa illegale; Il percorso non e' libero&quot;);</span>
          }

        } else {
<span class="nc" id="L1561">          throw new IllegalMoveException(</span>
              &quot;Mossa illegale; Il re o la torre sono gia' stati mossi in precedenza&quot;);
        }

      } else {
<span class="nc" id="L1566">        throw new IllegalMoveException(</span>
            &quot;Mossa illegale; Impossibile effettuare arrocco corto, re e torre non sono nella posizione iniziale&quot;);
      }
    } else {
<span class="nc bnc" id="L1570" title="All 4 branches missed.">      if ((board[0][4].getPiece() instanceof King) &amp;&amp; (board[0][7].getPiece() instanceof Rook)) {</span>
        // controllo che re e torre siano nella posizione corretta
<span class="nc" id="L1572">        King k = (King) board[0][4].getPiece();</span>
<span class="nc" id="L1573">        Rook r = (Rook) board[0][7].getPiece();</span>
<span class="nc bnc" id="L1574" title="All 2 branches missed.">        if ((k.getNumberOfMoves() == 0)</span>
<span class="nc bnc" id="L1575" title="All 2 branches missed.">            &amp;&amp; (r.getNumberOfMoves() == 0)) { // controllo che non siano stati</span>
          // ancora mossi

<span class="nc bnc" id="L1578" title="All 4 branches missed.">          if ((board[0][5].getPiece() == null) &amp;&amp; (board[0][6].getPiece() == null)) {</span>
<span class="nc bnc" id="L1579" title="All 2 branches missed.">            if ((King.isThreatened(0, 4))</span>
<span class="nc bnc" id="L1580" title="All 2 branches missed.">                || (King.isThreatened(0, 5))</span>
<span class="nc bnc" id="L1581" title="All 2 branches missed.">                || (King.isThreatened(0, 6))) { // controllo che il re non e', e non</span>
              // finisce sotto scacco durante la
              // mossa
<span class="nc" id="L1584">              throw new IllegalMoveException(</span>
                  &quot;Mossa illegale; Il re e' sotto scacco, o finirebbe sotto scacco effettuando l'arrocco&quot;);
            }
            // controllo se il percorso e' libero
<span class="nc" id="L1588">            k.incrementMoves();</span>
<span class="nc" id="L1589">            r.incrementMoves();</span>
<span class="nc" id="L1590">            board[0][6].setPiece(k);</span>
<span class="nc" id="L1591">            board[0][5].setPiece(r);</span>
<span class="nc" id="L1592">            board[0][4].setEmpty();</span>
<span class="nc" id="L1593">            board[0][7].setEmpty();</span>
<span class="nc" id="L1594">            movesDone.add(&quot;0-0&quot;);</span>
<span class="nc" id="L1595">            blackTurn = true;</span>
<span class="nc" id="L1596">            result[0] = &quot;0-0&quot;;</span>
<span class="nc" id="L1597">            return result;</span>
          } else {
<span class="nc" id="L1599">            throw new IllegalMoveException(&quot;Mossa illegale; Il percorso non e' libero&quot;);</span>
          }

        } else {
<span class="nc" id="L1603">          throw new IllegalMoveException(</span>
              &quot;Mossa illegale; Il re o la torre sono gia' stati mossi in precedenza&quot;);
        }

      } else {
<span class="nc" id="L1608">        throw new IllegalMoveException(</span>
            &quot;Mossa illegale; Impossibile effettuare arrocco corto, re e torre non sono nella posizione iniziale&quot;);
      }
    }
  }

  String[] longCastling() throws IllegalMoveException {
<span class="nc" id="L1615">    String[] result = new String[2];</span>
<span class="nc bnc" id="L1616" title="All 2 branches missed.">    if (blackTurn == true) {</span>
<span class="nc bnc" id="L1617" title="All 4 branches missed.">      if ((board[7][4].getPiece() instanceof King) &amp;&amp; (board[7][0].getPiece() instanceof Rook)) {</span>
        // controllo che re e torre siano nella posizione corretta
<span class="nc" id="L1619">        King k = (King) board[7][4].getPiece();</span>
<span class="nc" id="L1620">        Rook r = (Rook) board[7][0].getPiece();</span>
<span class="nc bnc" id="L1621" title="All 2 branches missed.">        if ((k.getNumberOfMoves() == 0)</span>
<span class="nc bnc" id="L1622" title="All 2 branches missed.">            &amp;&amp; (r.getNumberOfMoves() == 0)) { // controllo che non siano stati</span>
          // ancora mossi

<span class="nc bnc" id="L1625" title="All 4 branches missed.">          if ((board[7][3].getPiece() == null) &amp;&amp; (board[7][2].getPiece() == null)) {</span>
<span class="nc bnc" id="L1626" title="All 2 branches missed.">            if ((King.isThreatened(7, 4))</span>
<span class="nc bnc" id="L1627" title="All 2 branches missed.">                || (King.isThreatened(7, 3))</span>
                // controllo che il re non e', e non finisce sotto scacco durante la mossa
<span class="nc bnc" id="L1629" title="All 2 branches missed.">                || (King.isThreatened(7, 2))) {</span>
<span class="nc" id="L1630">              throw new IllegalMoveException(</span>
                  &quot;Mossa illegale; Il re e' sotto scacco, o finirebbe sotto scacco effettuando l'arrocco&quot;);
            }
            // controllo se il percorso e' libero
<span class="nc" id="L1634">            k.incrementMoves();</span>
<span class="nc" id="L1635">            r.incrementMoves();</span>
<span class="nc" id="L1636">            board[7][2].setPiece(k);</span>
<span class="nc" id="L1637">            board[7][3].setPiece(r);</span>
<span class="nc" id="L1638">            board[7][4].setEmpty();</span>
<span class="nc" id="L1639">            board[7][0].setEmpty();</span>
<span class="nc" id="L1640">            movesDone.add(&quot;0-0-0&quot;);</span>
<span class="nc" id="L1641">            result[0] = &quot;0-0-0&quot;;</span>
<span class="nc" id="L1642">            blackTurn = false;</span>
<span class="nc" id="L1643">            return result;</span>
          } else {
<span class="nc" id="L1645">            throw new IllegalMoveException(&quot;Mossa illegale; Il percorso non e' libero&quot;);</span>
          }

        } else {
<span class="nc" id="L1649">          throw new IllegalMoveException(</span>
              &quot;Mossa illegale; Il re o la torre sono gia' stati mossi in precedenza&quot;);
        }

      } else {
<span class="nc" id="L1654">        throw new IllegalMoveException(</span>
            &quot;Mossa illegale; Impossibile effettuare arrocco lungo, re e torre non sono nella posizione iniziale&quot;);
      }
    } else {
<span class="nc bnc" id="L1658" title="All 4 branches missed.">      if ((board[0][4].getPiece() instanceof King) &amp;&amp; (board[0][0].getPiece() instanceof Rook)) {</span>
        // controllo che re e torre siano nella posizione corretta
<span class="nc" id="L1660">        King k = (King) board[0][4].getPiece();</span>
<span class="nc" id="L1661">        Rook r = (Rook) board[0][0].getPiece();</span>
<span class="nc bnc" id="L1662" title="All 2 branches missed.">        if ((k.getNumberOfMoves() == 0)</span>
<span class="nc bnc" id="L1663" title="All 2 branches missed.">            &amp;&amp; (r.getNumberOfMoves() == 0)) { // controllo che non siano stati</span>
          // ancora mossi

<span class="nc bnc" id="L1666" title="All 4 branches missed.">          if ((board[0][3].getPiece() == null) &amp;&amp; (board[0][2].getPiece() == null)) {</span>
<span class="nc bnc" id="L1667" title="All 2 branches missed.">            if ((King.isThreatened(0, 4))</span>
<span class="nc bnc" id="L1668" title="All 2 branches missed.">                || (King.isThreatened(0, 3))</span>
<span class="nc bnc" id="L1669" title="All 2 branches missed.">                || (King.isThreatened(0, 2))) { // controllo che il re non e', e non</span>
              // finisce sotto scacco durante la
              // mossa
<span class="nc" id="L1672">              throw new IllegalMoveException(</span>
                  &quot;Mossa illegale; Il re e' sotto scacco, o finirebbe sotto scacco effettuando l'arrocco&quot;);
            }
            // controllo se il percorso e' libero
<span class="nc" id="L1676">            k.incrementMoves();</span>
<span class="nc" id="L1677">            r.incrementMoves();</span>
<span class="nc" id="L1678">            board[0][2].setPiece(k);</span>
<span class="nc" id="L1679">            board[0][3].setPiece(r);</span>
<span class="nc" id="L1680">            board[0][4].setEmpty();</span>
<span class="nc" id="L1681">            board[0][0].setEmpty();</span>
<span class="nc" id="L1682">            movesDone.add(&quot;0-0-0&quot;);</span>
<span class="nc" id="L1683">            result[0] = &quot;0-0-0&quot;;</span>
<span class="nc" id="L1684">            blackTurn = true;</span>
<span class="nc" id="L1685">            return result;</span>
          } else {
<span class="nc" id="L1687">            throw new IllegalMoveException(&quot;Mossa illegale; Il percorso non e' libero&quot;);</span>
          }

        } else {
<span class="nc" id="L1691">          throw new IllegalMoveException(</span>
              &quot;Mossa illegale; Il re o la torre sono gia' stati mossi in precedenza&quot;);
        }

      } else {
<span class="nc" id="L1696">        throw new IllegalMoveException(</span>
            &quot;Mossa illegale; Impossibile effettuare arrocco lungo, re e torre non sono nella posizione iniziale&quot;);
      }
    }
  }

  static boolean getBlackTurn() {
<span class="nc" id="L1703">    return blackTurn;</span>
  }

  static void changeTurn() {
<span class="nc bnc" id="L1707" title="All 2 branches missed.">    blackTurn = !blackTurn;</span>
<span class="nc" id="L1708">  }</span>

  static Cell getCell(int x, int y) {
<span class="nc" id="L1711">    return board[x][y];</span>
  }
  
  static void addMove(String move) {
<span class="nc" id="L1715">	    movesDone.add(move);</span>
<span class="nc" id="L1716">  }</span>

  ArrayList&lt;String&gt; getMoves() {
<span class="nc" id="L1719">    return movesDone;</span>
  }
  
  ArrayList&lt;String&gt; getBlacks() {
<span class="nc" id="L1723">	    return BlacksCaptured;</span>
  }

  ArrayList&lt;String&gt; getWhites() {
<span class="nc" id="L1727">	    return WhitesCaptured;</span>
  }
  
  static void addWhiteCaptured(String captured) {
<span class="nc" id="L1731">	  WhitesCaptured.add(captured.toString());</span>
<span class="nc" id="L1732">  }</span>
  
  static void addBlackCaptured(String captured) {
<span class="nc" id="L1735">	  BlacksCaptured.add(captured.toString());</span>
<span class="nc" id="L1736">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>